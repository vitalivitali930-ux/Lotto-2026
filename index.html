<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Lotto - –î–≤–∏–∂–æ–∫ VCHF Ultimate 2.0</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { 
            --main-color: #d4af37; 
            --main-gradient: linear-gradient(145deg, #f9e27d, #d4af37);
            --theme-glow: rgba(212, 175, 55, 0.35); 
            --sphere-base: #1a1a1a;
            --white-sphere: radial-gradient(circle at 35% 35%, #444 0%, #1a1a1a 40%, #000 100%);
            --gold-sphere: radial-gradient(circle at 35% 35%, #fff9d6 0%, #f9e27d 30%, #d4af37 60%, #8a6d1c 100%);
            --cell-text: #ffffff; 
            --hot-color: #ff4500;
            --cold-color: #1e90ff;
            --process-color: #00ffff;
        } 

        body { 
            background: #000; color: #fff; font-family: -apple-system, sans-serif; 
            text-align: center; margin: 0; overflow: hidden; 
        } 

        /* –°—Ç–∏–ª–∏ –¥–ª—è –Ω–æ–≤—ã—Ö —Ç–∞–±–æ–≤ –≤ –ò—Å—Ç–æ—Ä–∏–∏ –ë–∏–ª–µ—Ç–æ–≤ */
        .history-tabs {
            display: flex; justify-content: center; gap: 10px;
            margin: 10px 15px 20px; padding: 5px;
            background: rgba(255,255,255,0.05); border-radius: 15px;
        }
        .h-tab {
            flex: 1; padding: 10px; border-radius: 12px;
            border: 1px solid #333; background: #111;
            color: #666; font-size: 11px; font-weight: 800;
            cursor: pointer; transition: 0.3s;
        }
        .h-tab.active {
            border-color: var(--main-color); color: #fff;
            background: rgba(212,175,55,0.15);
            box-shadow: 0 0 10px var(--theme-glow);
        }

        /* –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ç–≤–æ–∏ —Å—Ç–∏–ª–∏ (—Å–µ—Ç–∫–∞, –∫–Ω–æ–ø–∫–∏, –∞–Ω–∏–º–∞—Ü–∏–∏) */
        .grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 10px; padding: 0 15px; }
        .cell { aspect-ratio: 1/1; background: var(--white-sphere); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 800; font-size: 19px; border: 1px solid rgba(255,255,255,0.1); }
        .cell.selected { background: var(--main-gradient); color: #000; transform: scale(1.1); box-shadow: 0 0 20px var(--main-color); }
        
        .nav-bar { position: fixed; bottom: 0; left: 0; right: 0; height: 70px; background: #0a0a0a; display: flex; border-top: 1.5px solid var(--main-color); }
        .nav-item { flex: 1; color: #666; display: flex; flex-direction: column; align-items: center; justify-content: center; font-size: 10px; }
        .nav-item.active { color: var(--main-color); }
        
        .ticket-card { background: rgba(255,255,255,0.05); border: 1px solid #333; border-radius: 15px; padding: 15px; margin: 0 15px 10px; text-align: left; }
    </style>
</head>
<body class="theme-gold">

<div id="legal-overlay">
    <div class="legal-box">
        <h2 id="legal-title">Rechtlicher Hinweis</h2>
        <div id="legal-content"></div>
        <button class="btn-main" onclick="acceptLegal()" id="legal-agree-btn">Akzeptieren</button>
    </div>
</div>

<div id="intro-container">
    <img src="1771489965074(1).png" class="intro-img" id="img-de">
</div>

<div id="app-content">
    <div id="page-play" class="page active">
        <div class="balance-container">
            <div id="bal-vchf" class="bal-card active-wallet" onclick="switchWallet('vchf')">
                <div style="font-size: 10px; color: #888;">VCHF Balance</div>
                <div class="bal-val" id="user-vchf">100.00</div>
            </div>
            <div id="bal-chf" class="bal-card" onclick="switchWallet('chf')">
                <div style="font-size: 10px; color: #888;">CHF Balance</div>
                <div class="bal-val" id="user-chf">0.00</div>
            </div>
        </div>

        <div class="stats-period">
            <button class="p-btn active" onclick="setPeriod('monat')">Monat</button>
            <button class="p-btn" onclick="setPeriod('jahr')">Jahr</button>
            <button class="p-btn" onclick="setPeriod('alle')">Alle</button>
        </div>

        <div class="grid" id="lotto-grid"></div>
        <button class="btn-main" onclick="runEngine()" id="buy-btn">TICKET KAUFEN (1.00)</button>
    </div>

    <div id="page-tickets" class="page">
        <h2 id="nav-hist">MEINE TICKETS</h2>
        <div class="history-tabs">
            <button class="h-tab active" id="tab-vchf" onclick="filterHistory('vchf')">VCHF TICKETS</button>
            <button class="h-tab" id="tab-chf" onclick="filterHistory('chf')">CHF TICKETS</button>
        </div>
        <div id="tickets-list"></div>
    </div>

    <div id="nav-bar" class="nav-bar">
        <div class="nav-item active" onclick="showPage('play')" id="nav-play-btn"><span>üé≤</span><div id="nav-play">SPIEL</div></div>
        <div class="nav-item" onclick="showPage('tickets')" id="nav-tickets-btn"><span>üéüÔ∏è</span><div id="nav-tickets">TICKETS</div></div>
        <div class="nav-item" onclick="showPage('stats')"><span>üìä</span><div id="nav-stats">STATS</div></div>
    </div>
</div>

<script>
    let activeWallet = 'vchf';
    let historyFilter = 'vchf'; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–º–æ—Ç—Ä–∏–º VCHF –∏—Å—Ç–æ—Ä–∏—é
    let tickets = JSON.parse(localStorage.getItem('lotto_tickets') || '[]');
    let balances = JSON.parse(localStorage.getItem('lotto_balances') || '{"vchf": 100.0, "chf": 0.0}');
    let selectedNumbers = [];

    function switchWallet(w) {
        activeWallet = w;
        document.querySelectorAll('.bal-card').forEach(c => c.classList.remove('active-wallet'));
        document.getElementById('bal-' + w).classList.add('active-wallet');
        updatePriceDisplay();
    }

    // –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏—Å—Ç–æ—Ä–∏–∏
    function filterHistory(currency) {
        historyFilter = currency;
        document.querySelectorAll('.h-tab').forEach(t => t.classList.remove('active'));
        document.getElementById('tab-' + currency).classList.add('active');
        renderTickets();
    }

    function runEngine() {
        if (selectedNumbers.length < 5) return alert("W√§hlen Sie 5 Zahlen!");
        let price = 1.0;
        if (balances[activeWallet] >= price) {
            balances[activeWallet] -= price;
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –±–∏–ª–µ—Ç –° –£–ö–ê–ó–ê–ù–ò–ï–ú –í–ê–õ–Æ–¢–´
            let newTicket = {
                nums: [...selectedNumbers],
                date: new Date().toLocaleString(),
                currency: activeWallet,
                id: Date.now()
            };
            tickets.unshift(newTicket);
            saveData();
            updateUI();
            selectedNumbers = [];
            refreshGrid();
            alert("Erfolg!");
        } else {
            alert("Nicht genug Guthaben!");
        }
    }

    function renderTickets() {
        const container = document.getElementById('tickets-list');
        // –§–∏–ª—å—Ç—Ä—É–µ–º –±–∏–ª–µ—Ç—ã –ø–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –≤–∫–ª–∞–¥–∫–µ
        const filtered = tickets.filter(t => t.currency === historyFilter);
        
        container.innerHTML = filtered.length ? '' : '<p style="color:#666; margin-top:20px;">Keine Tickets</p>';
        
        filtered.forEach(t => {
            let div = document.createElement('div');
            div.className = 'ticket-card';
            div.innerHTML = `
                <div style="font-size:10px; color:var(--main-color)">${t.date} | ${t.currency.toUpperCase()}</div>
                <div class="ticket-nums">
                    ${t.nums.map(n => `<div class="mini-ball">${n}</div>`).join('')}
                </div>
            `;
            container.innerHTML += div.outerHTML;
        });
    }

    function saveData() {
        localStorage.setItem('lotto_tickets', JSON.stringify(tickets));
        localStorage.setItem('lotto_balances', JSON.stringify(balances));
    }

    function updateUI() {
        document.getElementById('user-vchf').innerText = balances.vchf.toFixed(2);
        document.getElementById('user-chf').innerText = balances.chf.toFixed(2);
        renderTickets();
    }

    function showPage(p) {
        document.querySelectorAll('.page').forEach(pg => pg.classList.remove('active'));
        document.getElementById('page-' + p).classList.add('active');
        document.querySelectorAll('.nav-item').forEach(ni => ni.classList.remove('active'));
        document.getElementById('nav-' + p + '-btn').classList.add('active');
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ç–∫–∏ (–∑–∞–≥–ª—É—à–∫–∞ –¥–ª—è —Ç–µ—Å—Ç–∞)
    function refreshGrid() {
        const grid = document.getElementById('lotto-grid');
        grid.innerHTML = '';
        for(let i=1; i<=42; i++) {
            let cell = document.createElement('div');
            cell.className = 'cell';
            cell.innerText = i;
            cell.onclick = () => {
                if(selectedNumbers.includes(i)) {
                    selectedNumbers = selectedNumbers.filter(n => n !== i);
                } else if(selectedNumbers.length < 5) {
                    selectedNumbers.push(i);
                }
                cell.classList.toggle('selected');
            };
            grid.appendChild(cell);
        }
    }

    window.onload = () => {
        refreshGrid();
        updateUI();
        setTimeout(() => {
            document.getElementById('intro-container').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('intro-container').style.display = 'none';
                document.getElementById('app-content').style.display = 'block';
                document.getElementById('app-content').style.opacity = '1';
            }, 1000);
        }, 2000);
    };
</script>
</body>
</html>
