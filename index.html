<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Lotto - –î–≤–∏–∂–æ–∫ VCHF v1.1</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { 
            --main-color: #d4af37; 
            --main-gradient: linear-gradient(145deg, #f9e27d, #d4af37);
            --cell-text: #d4af37; 
            --hot-color: #ff4500;
            --cold-color: #1e90ff;
            --process-color: #00ffff; 
            /* –î–æ–±–∞–≤–ª—è–µ–º –≥—Ä–∞–¥–∏–µ–Ω—Ç –¥–ª—è –æ–±—ä–µ–º–∞ —à–∞—Ä–∞ */
            --ball-bg: radial-gradient(circle at 35% 35%, #ffffff 0%, #fcfcfc 25%, #e0e0e0 50%, #b3b3b3 100%);
        }

        body { 
            background: #000 url('Hintergrund.png') no-repeat center center; 
            background-size: cover; color: #fff; 
            font-family: -apple-system, sans-serif; 
            text-align: center; margin: 0; overflow: hidden; 
        }

        #intro-container {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000 url('Hintergrund.png') no-repeat center center; 
            background-size: cover; z-index: 20000; 
            display: flex; justify-content: center; align-items: center;
        }
        .intro-img { position: absolute; width: 85%; opacity: 0; pointer-events: none; }
        .intro-img.active { animation: shakePop 0.7s ease-out forwards; }
        @keyframes shakePop { 0% { transform: scale(0.1); opacity: 0; } 50% { transform: scale(1.05); opacity: 1; } 100% { transform: scale(1); opacity: 1; } }

        #app-content { display: none; opacity: 0; transition: opacity 1s ease; height: 100vh; overflow-y: auto; padding-top: 15px; }
        
        .lang-panel { display: flex; justify-content: center; gap: 12px; margin-bottom: 15px; }
        .lang-btn { font-size: 24px; cursor: pointer; }

        .balance-container { display: flex; gap: 10px; padding: 0 15px 15px; }
        .bal-card { 
            flex: 1; border-radius: 12px; padding: 12px; 
            background: rgba(15, 15, 15, 0.9); border: 1.5px solid #333; 
            transition: 0.5s ease; cursor: pointer;
            opacity: 0.15; filter: grayscale(1) brightness(0.6);
        }
        .bal-card.active-wallet { 
            opacity: 1; filter: grayscale(0) brightness(1);
            border-color: var(--main-color); 
            background: rgba(212, 175, 55, 0.1); 
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.2);
            transform: scale(1.05);
        }
        .bal-val { font-size: 20px; font-weight: bold; color: #32CD32; }

        body.theme-cherry .cell, body.theme-cherry .super-cell { color: #d4af37 !important; }

        .cell.is-hot, .super-cell.is-hot { 
            color: #ff4500 !important; 
            text-shadow: 0 0 10px #ff4500, 0 0 20px #ff0000, 0 0 5px #fff !important; 
            font-weight: 900;
        }
        .cell.is-cold, .super-cell.is-cold { 
            color: #00ffff !important; 
            text-shadow: 0 0 10px #00ffff, 0 0 20px #1e90ff, 0 0 5px #fff !important; 
            font-weight: 900;
        }

        .btn-topup, .btn-main { background: var(--main-gradient); color: #000; border: none; font-weight: bold; cursor: pointer; }
        .btn-topup { width: 85%; padding: 14px; border-radius: 10px; margin-bottom: 15px; }
        .btn-main { width: 85%; padding: 20px; border-radius: 15px; font-size: 18px; margin-top: 25px; margin-bottom: 50px; }

        .ticket-controls { margin-bottom: 20px; display: flex; flex-direction: column; align-items: center; gap: 10px; }
        .smart-tools { display: flex; gap: 8px; margin-bottom: 5px; }
        .tool-btn { padding: 6px 12px; border-radius: 15px; border: 1px solid var(--main-color); background: rgba(0,0,0,0.6); color: #fff; font-size: 11px; cursor: pointer; }
        
        .counter-box { display: flex; align-items: center; gap: 15px; background: rgba(255,255,255,0.1); padding: 8px 15px; border-radius: 20px; }
        .btn-round { width: 30px; height: 30px; border-radius: 50%; border: 1px solid var(--main-color); background: none; color: #fff; font-size: 18px; cursor: pointer; }

        .grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 10px; padding: 0 15px; max-width: 400px; margin: 0 auto; }

        /* –û–ë–ù–û–í–õ–ï–ù–ù–´–ô –î–ò–ó–ê–ô–ù –®–ê–†–û–í –í–ù–£–¢–†–ò –¢–í–û–ï–ô –°–ï–¢–ö–ò */
        .cell { 
            aspect-ratio: 1/1;
            background: var(--ball-bg); 
            border-radius: 50%; 
            display: flex; align-items: center; justify-content: center;
            font-weight: 900; font-size: 18px; color: #333; /* –¢–µ–∫—Å—Ç —Ç–µ–º–Ω—ã–π –¥–ª—è –±–µ–ª–æ–≥–æ —à–∞—Ä–∞ */
            box-shadow: inset -3px -3px 7px rgba(0,0,0,0.3), 2px 4px 8px rgba(0,0,0,0.5);
            transition: 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
            cursor: pointer; position: relative; 
        }
        /* –ë–ª–∏–∫ */
        .cell::before, .super-cell::before {
            content: ''; position: absolute; top: 12%; left: 15%; width: 30%; height: 20%; 
            background: rgba(255,255,255,0.8); border-radius: 50%; filter: blur(1px); pointer-events: none;
        }

        .cell.selected { background: var(--main-gradient) !important; color: #000 !important; transform: scale(1.1); box-shadow: 0 0 15px var(--main-color); }
        .cell.processing { background: var(--process-color) !important; color: #000 !important; transform: scale(1.1); }

        .super-title { margin: 25px 0 10px; font-size: 14px; color: var(--main-color); font-weight: bold; }
        .super-grid { display: flex; justify-content: center; gap: 10px; }
        .super-cell { 
            width: 42px; height: 42px; background: var(--ball-bg); border-radius: 50%; 
            display: flex; align-items: center; justify-content: center; color: #333; 
            font-weight: 900; cursor: pointer; transition: 0.2s; position: relative;
            box-shadow: inset -3px -3px 7px rgba(0,0,0,0.3), 2px 4px 8px rgba(0,0,0,0.5);
        }
        .super-cell.selected { background: var(--main-gradient) !important; color: #000 !important; transform: scale(1.1); }

        .theme-toggle { position: fixed; top: 15px; right: 15px; font-size: 26px; z-index: 1001; cursor: pointer; }
        .theme-panel { position: fixed; top: 60px; right: 15px; display: flex; flex-direction: column; gap: 12px; z-index: 1000; background: rgba(0,0,0,0.9); padding: 12px; border-radius: 20px; border: 1px solid var(--main-color); transition: 0.3s; transform: translateX(80px); }
        .theme-panel.open { transform: translateX(0); }
        .dot { width: 30px; height: 30px; border-radius: 50%; border: 2px solid #fff; cursor: pointer; }
    </style>
</head>
<body>

<div id="intro-container">
    <img src="Bild1.png" id="intro1" class="intro-img">
    <img src="Bild2.png" id="intro2" class="intro-img">
    <img src="Bild3.png" id="intro3" class="intro-img">
</div>

<div id="app-content">
    <div class="lang-panel">
        <span class="lang-btn" onclick="setLang('ru')">üá∑üá∫</span>
        <span class="lang-btn" onclick="setLang('ua')">üá∫üá¶</span>
        <span class="lang-btn" onclick="setLang('de')">üá©üá™</span>
        <span class="lang-btn" onclick="setLang('fr')">üá´üá∑</span>
        <span class="lang-btn" onclick="setLang('it')">üáÆüáπ</span>
    </div>

    <div class="theme-toggle" onclick="document.querySelector('.theme-panel').classList.toggle('open')">üé®</div>
    <div class="theme-panel">
        <div class="dot" style="background: #d4af37;" onclick="setTheme('gold')"></div>
        <div class="dot" style="background: #32CD32;" onclick="setTheme('lime')"></div>
        <div class="dot" style="background: #c0c0c0;" onclick="setTheme('silver')"></div>
        <div class="dot" style="background: #00ffff;" onclick="setTheme('cyan')"></div>
        <div class="dot" style="background: #C511A4;" onclick="setTheme('cherry')"></div>
    </div>

    <div class="balance-container">
        <div class="bal-card active-wallet" id="card-vchf" onclick="switchCurrency('VCHF')">
            <div style="font-size:10px; color:var(--main-color)">VIRTUAL VCHF</div>
            <div class="bal-val" id="vchf-val">100.00</div>
        </div>
        <div class="bal-card" id="card-chf" onclick="switchCurrency('CHF')">
            <div style="font-size:10px; color:var(--main-color)">REAL CHF</div>
            <div class="bal-val" id="chf-val">0.00</div>
        </div>
    </div>
    
    <button class="btn-topup" id="topup-btn">üí∞ BALANCE AUFF√úLLEN</button>

    <div class="ticket-controls">
        <div class="smart-tools">
            <button class="tool-btn" onclick="toggleHeatmap('hot')" id="btn-hot">üî• HOT</button>
            <button class="tool-btn" onclick="toggleHeatmap('cold')" id="btn-cold">‚ùÑÔ∏è COLD</button>
            <button class="tool-btn" onclick="randomFill()">üé≤ RANDOM</button>
        </div>
        <div class="stats-period" id="stats-p-box">
            <button class="p-btn active" onclick="setPeriod('month')" id="p-month">MONTH</button>
            <button class="p-btn" onclick="setPeriod('year')" id="p-year">YEAR</button>
            <button class="p-btn" onclick="setPeriod('all')" id="p-all">ALL TIME</button>
        </div>
        <div class="counter-box">
            <button class="btn-round" onclick="updateTicketCount(-1)">‚àí</button>
            <span id="ticket-count" style="font-size: 18px; font-weight: bold;">1</span>
            <button class="btn-round" onclick="updateTicketCount(1)">+</button>
        </div>
        <div style="font-size: 12px; color: #aaa;">TOTAL: <span id="total-price" style="color:#fff">2.50</span> <span id="currency-label">VCHF</span></div>
    </div>

    <div class="grid" id="main-grid"></div>
    <div id="l-super" class="super-title">SUPERZAHL</div>
    <div class="super-grid" id="s-grid"></div>
    <button class="btn-main" id="main-btn" onclick="runEngine()">TICKET BEST√ÑTIGEN</button>
</div>

<script>
    // --- –ó–í–£–ö–û–í–û–ô –î–í–ò–ñ–û–ö VCHF ---
    const sndClick = new Audio('https://www.soundjay.com/buttons/sounds/button-16.mp3');
    const sndRoll = new Audio('https://www.soundjay.com/misc/sounds/marbles-rolling-1.mp3');
    const sndWin = new Audio('https://www.soundjay.com/buttons/sounds/button-3.mp3');

    const tg = window.Telegram.WebApp;
    tg.expand();
    const root = document.documentElement;

    const PREIS_PRO_TICKET = 2.50;
    let vchfBalance = 100.00;
    let chfBalance = 0.00;
    let ticketCount = 1;
    let selected = [];
    let superNum = null;
    let activeCurrency = 'VCHF';
    let isProcessing = false;
    let currentMode = null; 
    let currentPeriod = 'month';

    const dbStats = {
        month: { hot: [3, 11, 25, 29, 34, 42], cold: [1, 14, 20, 28, 33, 39], superHot: [5, 3], superCold: [2, 6], freq: {3: 5, 11: 4, 25: 4, 29: 3, 34: 3, 42: 3, 1: 0, 14: 0, 20: 0, 28: 0, 33: 0, 39: 0} },
        year:  { hot: [7, 18, 22, 31, 35, 41], cold: [4, 9, 15, 26, 30, 38], superHot: [1, 5], superCold: [4, 3], freq: {7: 54, 18: 51, 22: 48, 31: 46, 35: 43, 41: 42, 4: 11, 9: 9, 15: 7, 26: 6, 30: 4, 38: 2} },
        all:   { hot: [42, 12, 19, 1, 23, 37], cold: [2, 10, 17, 21, 32, 40], superHot: [3, 2], superCold: [6, 1], freq: {42: 492, 12: 478, 19: 465, 1: 459, 23: 451, 37: 447, 2: 112, 10: 105, 17: 98, 21: 92, 32: 85, 40: 71} }
    };

    const humorDict = {
        ru: { all_hot: ["–ó–∞–π—á–∏–∫ ‚Äî —á–µ–º–ø–∏–æ–Ω –ø–æ –∫–∞–ø–∫–∞–Ω–∞–º!", "–ñ–µ–ª–µ–∑–Ω—ã–π –§–µ–ª–∏–∫—Å ‚Äî –≤ —Å—Ç—Ä–æ—é –≤—Å–µ–≥–¥–∞.", "–ó–æ–ª–æ—Ç–æ–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç –ë–µ—Ä–Ω–∞.", "–ü–µ—Ä–≤—ã–π –ø–∞—Ä–µ–Ω—å –Ω–∞ –¥–µ—Ä–µ–≤–Ω–µ!", "–ú–∞–≥–Ω–∏—Ç –¥–ª—è —É–¥–∞—á–∏ ‚Äî –∫—Ä–∞—Å–∫–∞ —Å—Ç–µ—Ä–ª–∞—Å—å.", "–°—Ç–∞—Ö–∞–Ω–æ–≤–µ—Ü ‚Äî –ø–∞—à–µ—Ç –±–µ–∑ –≤—ã—Ö–æ–¥–Ω—ã—Ö."], all_cold: ["–ù–∞—Å—Ç–æ—è—â–∏–π –º–∞–º–æ–Ω—Ç ‚Äî –≤—ã–º–µ—Ä –¥–∞–≤–Ω–æ.", "–ë–µ—Ä–º—É–¥—Å–∫–∏–π —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫ ‚Äî –ø—Ä–æ–ø–∞–ª.", "–ü—Ä–∏–∑—Ä–∞–∫ –æ–ø–µ—Ä—ã ‚Äî –Ω–∏–∫—Ç–æ –Ω–µ –≤–∏–¥–µ–ª.", "–°–ø—è—â–∏–π –∫—Ä–∞—Å–∞–≤–µ—Ü ‚Äî —Å–ø–∏—Ç –≤–µ–∫.", "–°–∫—Ä–æ–º–Ω—ã–π –æ—Ç—à–µ–ª—å–Ω–∏–∫ –∏–∑ –ª–µ—Å–∞.", "–ó–∞–±—ã—Ç—ã–π –±–∞–≥–∞–∂ –Ω–∞ —Å–∫–ª–∞–¥–µ."], year_hot: ["–ó–≤–µ–∑–¥–∞ —Å–æ—Ü—Å–µ—Ç–µ–π –≥–æ–¥–∞!", "–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫ ‚Äî –∑–∞—Ä—è–∂–µ–Ω –Ω–∞ —É—Å–ø–µ—Ö.", "–ö–∞—Ä—å–µ—Ä–∏—Å—Ç ‚Äî –ø—Ä–µ—Ç –ø–æ –≥–æ–ª–æ–≤–∞–º.", "–ú–∏—Å—Ç–µ—Ä –ü–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å ‚Äî —á–∞—â–µ –ø–∏—Ü—Ü—ã.", "–ù–∞ —Ö–∞–π–ø–µ! –õ–æ–≤–∏—Ç –≤–æ–ª–Ω—É.", "–®–≤–µ–π—Ü–∞—Ä—Å–∫–∏–µ —á–∞—Å—ã ‚Äî –±–µ–∑ —Å–±–æ–µ–≤."], year_cold: ["–í –≥–ª—É–±–æ–∫–æ–º –æ—Ñ—à–æ—Ä–µ.", "–£—à–µ–ª –≤ –¥–µ–∫—Ä–µ—Ç ‚Äî –æ—Ç–¥—ã—Ö–∞–µ—Ç.", "–ü–∞—Ä—Ç–∏–∑–∞–Ω –≤ –∑–∞—Å–∞–¥–µ.", "–ü–æ—Ç–µ—Ä—è–ª –∫–ª—é—á–∏ –æ—Ç –ª–æ—Ç–æ—Ç—Ä–æ–Ω–∞.", "–ü—Ä–æ–≥—É–ª—å—â–∏–∫ ‚Äî –≤–∏–¥–µ–ª–∏ –≤ –±—É—Ñ–µ—Ç–µ.", "–ö–æ—Å–º–æ–Ω–∞–≤—Ç ‚Äî —Å–≤—è–∑–∏ –Ω–µ—Ç."], month_hot: ["–°–ø—Ä–∏–Ω—Ç–µ—Ä –º–µ—Å—è—Ü–∞ ‚Äî –Ω–µ—Å–µ—Ç—Å—è!", "–ì–ª–∞–≤–Ω—ã–π –≤—ã—Å–∫–æ—á–∫–∞ ‚Äî —É–∂–µ —Ç—É—Ç.", "–õ—é–±–∏–º—á–∏–∫ ‚Äî –ø–æ–¥–º–∏–≥–∏–≤–∞–µ—Ç —à–∞—Ä–∞–º.", "–í —Ä–µ–∂–∏–º–µ –§–æ—Ä—Å–∞–∂–∞!", "–ì–æ—Ä—è—á–∏–π –ø–∏—Ä–æ–∂–æ–∫ –∏–∑ –ø–µ—á–∏.", "–ê–±–æ–Ω–µ–º–µ–Ω—Ç –Ω–∞ –≤—Å–µ —Ç–∏—Ä–∞–∂–∏."], month_cold: ["–°—Ç–µ—Å–Ω—è—à–∫–∞ ‚Äî –ø—Ä—è—á–µ—Ç—Å—è –∑–∞ –≤—Å–µ—Ö.", "–ù–∞ –±–æ–ª—å–Ω–∏—á–Ω–æ–º ‚Äî –≥–æ—Ä–ª–æ –±–æ–ª–∏—Ç.", "–î–µ—Ä–∂–∏—Ç –¥–∏—Å—Ç–∞–Ω—Ü–∏—é ‚Äî –∏–∑–æ–ª—è—Ü–∏—è.", "–°–ª–∏—à–∫–æ–º –∑–∞–Ω—è—Ç –≤ –¥—Ä—É–≥–∏—Ö –∏–≥—Ä–∞—Ö.", "–í–Ω–µ –∑–æ–Ω—ã –¥–æ—Å—Ç—É–ø–∞.", "–¢—É—Ä–∏—Å—Ç –≤ –≥–æ—Ä–∞—Ö ‚Äî —à–ª–µ—Ç –æ—Ç–∫—Ä—ã—Ç–∫—É."], times: "—Ä–∞–∑(–∞)" },
        ua: { all_hot: ["–ó–∞–π—á–∏–∫ ‚Äî —á–µ–º–ø—ñ–æ–Ω –ø–æ –∫–∞–ø–∫–∞–Ω–∞—Ö!", "–ó–∞–ª—ñ–∑–Ω–∏–π –§–µ–ª—ñ–∫—Å ‚Äî –∑–∞–≤–∂–¥–∏ –≤ —Å—Ç—Ä–æ—é.", "–ó–æ–ª–æ—Ç–æ–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç –ë–µ—Ä–Ω–∞.", "–ü–µ—Ä—à–∏–π —Ö–ª–æ–ø–µ—Ü—å –Ω–∞ —Å–µ–ª—ñ!", "–ú–∞–≥–Ω—ñ—Ç –¥–ª—è —É–¥–∞—á—ñ ‚Äî —Ñ–∞—Ä–±–∞ —Å—Ç–µ—Ä–ª–∞—Å—è.", "–°—Ç–∞—Ö–∞–Ω–æ–≤–µ—Ü—å ‚Äî –æ—Ä–µ –±–µ–∑ –≤–∏—Ö—ñ–¥–Ω–∏—Ö."], all_cold: ["–°–ø—Ä–∞–≤–∂–Ω—ñ–π –º–∞–º–æ–Ω—Ç ‚Äî –≤–∏–º–µ—Ä –¥–∞–≤–Ω–æ.", "–ë–µ—Ä–º—É–¥—Å—å–∫–∏–π —Ç—Ä–∏–∫—É—Ç–Ω–∏–∫ ‚Äî –∑–Ω–∏–∫.", "–ü—Ä–∏–≤–∏–¥ –æ–ø–µ—Ä–∏ ‚Äî –Ω—ñ—Ö—Ç–æ –Ω–µ –±–∞—á–∏–≤.", "–°–ø–ª—è—á–∏–π –∫—Ä–∞—Å–µ–Ω—å ‚Äî —Å–ø–∏—Ç—å –≤—ñ–∫.", "–°–∫—Ä–æ–º–Ω–∏–π –≤—ñ–¥—à–µ–ª—å–Ω–∏–∫ –∑ –ª—ñ—Å—É.", "–ó–∞–±—É—Ç–∏–π –±–∞–≥–∞–∂ –Ω–∞ —Å–∫–ª–∞–¥—ñ."], year_hot: ["–ó—ñ—Ä–∫–∞ —Å–æ—Ü–º–µ—Ä–µ–∂ —Ä–æ–∫—É!", "–ï–Ω–µ—Ä–≥–µ—Ç–∏–∫ ‚Äî –∑–∞—Ä—è–¥–∂–µ–Ω–∏–π –Ω–∞ —É—Å–ø—ñ—Ö.", "–ö–∞—Ä'—î—Ä–∏—Å—Ç ‚Äî –ø—Ä–µ –ø–æ –≥–æ–ª–æ–≤–∞—Ö.", "–ú—ñ—Å—Ç–µ—Ä –ü–æ–ø—É–ª—è—Ä–Ω—ñ—Å—Ç—å ‚Äî —á–∞—Å—Ç—ñ—à–µ –∑–∞ –ø—ñ—Ü—É.", "–ù–∞ —Ö–∞–π–ø—ñ! –õ–æ–≤–∏—Ç—å —Ö–≤–∏–ª—é.", "–®–≤–µ–π—Ü–∞—Ä—Å—å–∫–∏–π –≥–æ–¥–∏–Ω–Ω–∏–∫ ‚Äî –±–µ–∑ –∑–±–æ—ó–≤."], year_cold: ["–£ –≥–ª–∏–±–æ–∫–æ–º—É –æ—Ñ—à–æ—Ä—ñ.", "–ü—ñ—à–æ–≤ —É –¥–µ–∫—Ä–µ—Ç ‚Äî –≤—ñ–¥–ø–æ—á–∏–≤–∞—î.", "–ü–∞—Ä—Ç–∏–∑–∞–Ω —É –∑–∞—Å—ñ–¥—Ü—ñ.", "–ó–∞–≥—É–±–∏–≤ –∫–ª—é—á—ñ –≤—ñ–¥ –ª–æ—Ç–æ—Ç—Ä–æ–Ω–∞.", "–ü—Ä–æ–≥—É–ª—å–Ω–∏–∫ ‚Äî –±–∞—á–∏–ª–∏ –≤ –±—É—Ñ–µ—Ç—ñ.", "–ö–æ—Å–º–æ–Ω–∞–≤—Ç ‚Äî –∑–≤'—è–∑–∫—É –Ω–µ–º–∞—î."], month_hot: ["–°–ø—Ä–∏–Ω—Ç–µ—Ä –º—ñ—Å—è—Ü—è ‚Äî –º—á–∏—Ç—å!", "–ì–æ–ª–æ–≤–Ω–∏–π –≤—ã—Å–∫–æ—á–∫–∞ ‚Äî –≤–∂–µ —Ç—É—Ç.", "–£–ª—é–±–ª–µ–Ω–µ—Ü—å ‚Äî –ø—ñ–¥–º–∏–≥—É—î –∫—É–ª—è–º.", "–í —Ä–µ–∂–∏–º—ñ –§–æ—Ä—Å–∞–∂—É!", "–ì–∞—Ä—è—á–∏–π –ø–∏—Ä—ñ–∂–æ–∫ –∑ –ø–µ—á—ñ.", "–ê–±–æ–Ω–µ–º–µ–Ω—Ç –Ω–∞ –≤—Å—ñ —Ç–∏—Ä–∞–∂—ñ."], month_cold: ["–°–æ—Ä–æ–º'—è–∑–ª–∏–≤–∏–π ‚Äî —Ö–æ–≤–∞—î—Ç—å—Å—è –∑–∞ –≤—Å—ñ—Ö.", "–ù–∞ –ª—ñ–∫–∞—Ä–Ω—è–Ω–æ–º—É ‚Äî –≥–æ—Ä–ª–æ –±–æ–ª–∏—Ç—å.", "–¢—Ä–∏–º–∞—î –¥–∏—Å—Ç–∞–Ω—Ü—ñ—é ‚Äî —ñ–∑–æ–ª—è—Ü—ñ—è.", "–ó–∞–Ω–∞–¥—Ç–æ –∑–∞–π–Ω—è—Ç–∏–π –≤ —ñ–Ω—à–∏—Ö —ñ–≥—Ä–∞—Ö.", "–ü–æ–∑–∞ –∑–æ–Ω–æ—é –¥–æ—Å—è–∂–Ω–æ—Å—Ç—ñ.", "–¢—É—Ä–∏—Å—Ç —É –≥–æ—Ä–∞—Ö ‚Äî —à–ª–µ –ª–∏—Å—Ç—ñ–≤–∫—É."], times: "—Ä–∞–∑(—ñ–≤)" },
        de: { all_hot: ["Hase ‚Äî Champion in der Falle!", "Eiserner Felix ‚Äî immer im Dienst.", "Berns Goldstandard.", "Der Dorf√§lteste!", "Gl√ºcksmagnet ‚Äî Farbe ist ab.", "Stachanowez ‚Äî arbeitet ohne Pause."], all_cold: ["Echtes Mammut ‚Äî l√§ngst ausgestorben.", "Bermuda-Dreieck ‚Äî verschwunden.", "Phantom der Oper ‚Äî nie gesehen.", "Dornr√∂schen ‚Äî schl√§ft ewig.", "Bescheidener Eremit aus dem Wald.", "Vergessenes Gep√§ck im Lager."], year_hot: ["Social-Media-Star des Jahres!", "Energy-Drink ‚Äî geladen auf Erfolg.", "Karrierist ‚Äî geht √ºber Leichen.", "Mr. Popularit√§t ‚Äî √∂fter als Pizza.", "Auf dem Hype! Reitet die Welle.", "Schweizer Uhr ‚Äî ohne Fehler."], year_cold: ["In der Tiefsee-Offshore.", "Im Mutterschutz ‚Äî ruht sich aus.", "Partisan im Hinterhalt.", "Schl√ºssel zum Lotto verloren.", "Schw√§nzer ‚Äî in der Kantine gesehen.", "Astronaut ‚Äî kein Kontakt."], month_hot: ["Monats-Sprinter ‚Äî rast!", "Haupt-Empork√∂mmling ‚Äî schon da.", "Gl√ºckspilz ‚Äî zwinkert den Kugeln.", "Im Fast & Furious Modus!", "Hei√ües Pirogge aus dem Ofen.", "Dauerkarte f√ºr alle Ziehungen."], month_cold: ["Sch√ºchtern ‚Äî versteckt sich.", "Krankgeschrieben ‚Äî Halsweh.", "H√§lt Distanz ‚Äî Isolation.", "Zu besch√§ftigt in anderen Spielen.", "Au√üer Reichweite ‚Äî kein Signal.", "Tourist in Bergen ‚Äî schickt Karte."], times: "Mal" },
        fr: { all_hot: ["Lapin ‚Äî champion du pi√®ge !", "F√©lix de fer ‚Äî toujours l√†.", "Standard d'or de Berne.", "Le beau gosse du village !", "Aimant √† chance ‚Äî peinture us√©e.", "Stakhanoviste ‚Äî travaille sans arr√™t."], all_cold: ["Vrai mammouth ‚Äî disparu depuis peu.", "Triangle des Bermudes ‚Äî perdu.", "Fant√¥me de l'op√©ra ‚Äî jamais vu.", "Beau au bois dormant ‚Äî dort encore.", "Ermite modeste de la for√™t.", "Bagage oubli√© au d√©p√¥t."], year_hot: ["Star des r√©seaux de l'ann√©e !", "√ânerg√©tique ‚Äî charg√© √† bloc.", "Carri√©riste ‚Äî fonce t√™te bayis√©e.", "Mr Popularit√© ‚Äî plus que la pizza.", "Sur le buzz ! Surfe sur la vague.", "Montre suisse ‚Äî sans faille."], year_cold: ["En offshore profond.", "En cong√© ‚Äî se repose.", "Partisan en embuscade.", "A perdu les cl√©s du loto.", "Absent√©iste ‚Äî vu √† la caf√©t√©ria.", "Astronaute ‚Äî aucun signal."], month_hot: ["Sprinteur du mois ‚Äî fonce !", "L'intrus principal ‚Äî d√©j√† l√†.", "Chouchou ‚Äî fait un clin d'≈ìil.", "En mode Fast & Furious !", "Petit pain chaud du four.", "Abonnement √† toutes les tirages."], month_cold: ["Timide ‚Äî se cache derri√®re.", "En cong√© maladie ‚Äî mal √† la gorge.", "Garde ses distances ‚Äî isolation.", "Trop occup√© ailleurs.", "Hors zone ‚Äî aucun signal.", "Touriste en montagne ‚Äî envoie une carte."], times: "fois" },
        it: { all_hot: ["Coniglietto ‚Äî campione di trappole!", "Felix di ferro ‚Äî sempre in linea.", "Standard d'oro di Berna.", "Il pi√π bello del villaggio!", "Calamita per la fortuna.", "Stacanovista ‚Äî lavora sempre."], all_cold: ["Vero mammut ‚Äî estinto da tempo.", "Triangolo delle Bermuda ‚Äî sparito.", "Fantasma dell'opera ‚Äî mai visto.", "Bella addormentata ‚Äî dorme da un secolo.", "Eremita modesto del bosco.", "Bagaglio dimenticato in deposito."], year_hot: ["Star dei social dell'anno!", "Energetico ‚Äî carico di successo.", "Carrierista ‚Äî va dritto alla meta.", "Mr Popolarit√† ‚Äî pi√π della pizza.", "Sull'hype! Cavalca l'onda.", "Orologio svizzero ‚Äî senza errori."], year_cold: ["In offshore profondo.", "In maternit√† ‚Äî si ripos–∞.", "Partigiano in agguato.", "Ha perso le chiavi del loto.", "Assenteista ‚Äî visto al bar.", "Astronauta ‚Äî nessun segnale."], month_hot: ["Sprinter del mese ‚Äî corre!", "Il primo arrivato ‚Äî gi√† qui.", "Il preferito ‚Äî fa l'occhiolino.", "In modalit√† Fast & Furious!", "Focaccina calda dal forno.", "Abbonamento a tutte le estrazioni."], month_cold: ["Timide ‚Äî se hide.", "In malattia ‚Äî mal di gola.", "Mantiene le distanze ‚Äî isolamento.", "Troppo occupato altrove.", "Fuori portata ‚Äî nessun segnale.", "Turista in montagna ‚Äî manda una cartolina."], times: "volte" }
    };

    const dict = {
        ru: { btn: "–ü–û–î–¢–í–ï–†–î–ò–¢–¨", super: "–ë–û–ù–£–°–ù–û–ï –ß–ò–°–õ–û", topup: "üí∞ –ü–û–ü–û–õ–ù–ò–¢–¨ –ë–ê–õ–ê–ù–°", hot: "–ì–û–†–Ø–ß–ï–ï", cold: "–•–û–õ–û–î–ù–û–ï", month: "–ú–ï–°–Ø–¶", year: "–ì–û–î", all: "–í–°–Å –í–†–ï–ú–Ø", alert: "–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –±–∏–ª–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é!" },
        ua: { btn: "–ü–Ü–î–¢–í–ï–†–î–ò–¢–ò", super: "–ë–û–ù–£–°–ù–ï –ß–ò–°–õ–û", topup: "üí∞ –ü–û–ü–û–í–ù–ò–¢–ò –ë–ê–õ–ê–ù–°", hot: "–ì–ê–†–Ø–ß–ï", cold: "–•–û–õ–û–î–ù–ï", month: "–ú–Ü–°–Ø–¶–¨", year: "–†–Ü–ö", all: "–í–ï–°–¨ –ß–ê–°", alert: "–ó–∞–ø–æ–≤–Ω—ñ—Ç—å –∫–≤–∏—Ç–æ–∫ –ø–æ–≤–Ω—ñ—Å—Ç—é!" },
        de: { btn: "BEST√ÑTIGEN", super: "SUPERZAHL", topup: "üí∞ BALANCE AUFF√úLLEN", hot: "HEISS", cold: "KALT", month: "MONAT", year: "JAHR", all: "GESAMT", alert: "Ticket vollst√§ndig ausf√ºllen!" },
        fr: { btn: "CONFIRMER", super: "NOMBRE BONUS", topup: "üí∞ RECHARGER", hot: "CHAUD", cold: "FROID", month: "MOIS", year: "AN", all: "TOTAL", alert: "Remplissez le ticket!" },
        it: { btn: "CONFERMA", super: "NUMERO BONUS", topup: "üí∞ RICARICA", hot: "CALDO", cold: "FREDDO", month: "MESE", year: "ANNO", all: "TOTALE", alert: "Completa il biglietto!" }
    };
    let currentLang = 'de';

    function switchCurrency(type) {
        activeCurrency = type;
        document.getElementById('card-vchf').classList.toggle('active-wallet', type === 'VCHF');
        document.getElementById('card-chf').classList.toggle('active-wallet', type === 'CHF');
        document.getElementById('currency-label').innerText = type;
        tg.HapticFeedback.impactOccurred('medium');
    }

    function setLang(l) {
        currentLang = l;
        document.getElementById('main-btn').innerText = dict[l].btn;
        document.getElementById('l-super').innerText = dict[l].super;
        document.getElementById('topup-btn').innerText = dict[l].topup;
        document.getElementById('p-month').innerText = dict[l].month;
        document.getElementById('p-year').innerText = dict[l].year;
        document.getElementById('p-all').innerText = dict[l].all;
        tg.HapticFeedback.selectionChanged();
    }

    function toggleHeatmap(type) {
        const box = document.getElementById('stats-p-box');
        if (currentMode === type) { currentMode = null; box.classList.remove('visible'); document.getElementById('btn-hot').classList.remove('active-hot'); document.getElementById('btn-cold').classList.remove('active-cold'); } 
        else { currentMode = type; box.classList.add('visible'); document.getElementById('btn-hot').classList.toggle('active-hot', type === 'hot'); document.getElementById('btn-cold').classList.toggle('active-cold', type === 'cold'); }
        refreshGrid();
    }

    function setPeriod(p) {
        currentPeriod = p;
        document.querySelectorAll('.p-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(`p-${p}`).classList.add('active');
        refreshGrid();
        tg.HapticFeedback.impactOccurred('light');
    }

    function refreshGrid() {
        document.querySelectorAll('.cell, .super-cell').forEach(c => c.classList.remove('is-hot', 'is-cold'));
        if (!currentMode) return;
        const list = dbStats[currentPeriod][currentMode];
        list.forEach(n => { const el = document.getElementById(`cell-${n}`); if (el) el.classList.add(currentMode === 'hot' ? 'is-hot' : 'is-cold'); });
        const sList = (currentMode === 'hot') ? dbStats[currentPeriod].superHot : dbStats[currentPeriod].superCold; 
        const sCells = document.querySelectorAll('.super-cell');
        sList.forEach(sn => { if (sCells[sn-1]) sCells[sn-1].classList.add(currentMode === 'hot' ? 'is-hot' : 'is-cold'); });
    }

    function showCellInfo(n, isSuper = false) {
        if (!currentMode) return;
        const stats = dbStats[currentPeriod];
        const list = stats[currentMode];
        const index = list.indexOf(n);
        if (index !== -1) {
            const langData = humorDict[currentLang] || humorDict['de'];
            const periodKey = `${currentPeriod}_${currentMode}`;
            const funnyText = langData[periodKey][index];
            const count = stats.freq[n];
            tg.showScanQrPopup({ text: `${isSuper ? 'Super' : 'Zahl'} ${n}\n\n${funnyText}\n(${count} ${langData.times})` });
        }
        setTimeout(() => tg.closeScanQrPopup(), 4000);
    }

    function randomFill() {
        if (isProcessing) return;
        isProcessing = true;
        sndRoll.currentTime = 0; sndRoll.play(); // –ó–≤—É–∫ —Ä–æ–ª–ª–∞
        const cells = document.querySelectorAll('.cell');
        const superCells = document.querySelectorAll('.super-cell');
        let iteration = 0; const totalSteps = 24; let currentDelay = 50;
        function step() {
            cells.forEach(c => c.classList.remove('selected', 'processing'));
            superCells.forEach(sc => sc.classList.remove('selected'));
            for(let i = 0; i < 6; i++) {
                let r = Math.floor(Math.random() * 42) + 1;
                document.getElementById(`cell-${r}`).classList.add('processing');
            }
            tg.HapticFeedback.impactOccurred('light');
            iteration++;
            if (iteration < totalSteps) { if (iteration > totalSteps * 0.6) currentDelay += 28; setTimeout(step, currentDelay); } 
            else { finalizeSelection(); }
        }
        function finalizeSelection() {
            sndRoll.pause(); sndWin.play(); // –§–∏–Ω–∏—à–Ω—ã–π –∑–≤—É–∫
            selected = [];
            cells.forEach(c => c.classList.remove('selected', 'processing'));
            while(selected.length < 6) {
                let r = Math.floor(Math.random() * 42) + 1;
                if(!selected.includes(r)) { selected.push(r); document.getElementById(`cell-${r}`).classList.add('selected'); }
            }
            superNum = Math.floor(Math.random() * 6) + 1;
            superCells[superNum-1].classList.add('selected');
            isProcessing = false;
            tg.HapticFeedback.notificationOccurred('success');
        }
        step();
    }

    const gridDiv = document.getElementById('main-grid');
    for (let i = 1; i <= 42; i++) {
        const c = document.createElement('div'); 
        c.className = 'cell'; c.id = `cell-${i}`; c.innerText = i;
        c.onclick = () => {
            if(isProcessing) return;
            if(currentMode && (c.classList.contains('is-hot') || c.classList.contains('is-cold'))) { showCellInfo(i); }
            if(selected.includes(i)) { selected = selected.filter(n => n !== i); c.classList.remove('selected'); }
            else if(selected.length < 6) { 
                selected.push(i); c.classList.add('selected'); 
                sndClick.currentTime = 0; sndClick.play(); // –ó–≤—É–∫ –∫–ª–∏–∫–∞
                tg.HapticFeedback.impactOccurred('light'); 
            }
        };
        gridDiv.appendChild(c);
    }

    const sGridDiv = document.getElementById('s-grid');
    for (let i = 1; i <= 6; i++) {
        const sc = document.createElement('div'); 
        sc.className = 'super-cell'; sc.innerText = i;
        sc.onclick = () => {
            if(isProcessing) return;
            if(currentMode && (sc.classList.contains('is-hot') || sc.classList.contains('is-cold'))) { showCellInfo(i, true); }
            document.querySelectorAll('.super-cell').forEach(x => x.classList.remove('selected'));
            superNum = i; sc.classList.add('selected'); 
            sndClick.currentTime = 0; sndClick.play(); // –ó–≤—É–∫ –∫–ª–∏–∫–∞
            tg.HapticFeedback.impactOccurred('medium');
        };
        sGridDiv.appendChild(sc);
    }

    function runEngine() {
        if (selected.length !== 6 || !superNum) { tg.showAlert(dict[currentLang].alert); return; }
        let total = ticketCount * PREIS_PRO_TICKET;
        let balance = (activeCurrency === 'VCHF') ? vchfBalance : chfBalance;
        if (balance >= total) {
            if (activeCurrency === 'VCHF') { vchfBalance -= total; document.getElementById('vchf-val').innerText = vchfBalance.toFixed(2); }
            else { chfBalance -= total; document.getElementById('chf-val').innerText = chfBalance.toFixed(2); }
            document.getElementById('app-content').style.pointerEvents = 'none';
            const btn = document.getElementById('main-btn');
            btn.disabled = true; btn.innerText = "FIXIERT (19:15)"; btn.style.background = "#444";
            tg.HapticFeedback.notificationOccurred('success');
            tg.showAlert(`Ticket fixiert via ${activeCurrency}!`);
        } else { tg.showAlert(`Insufficient balance!`); }
    }

    window.onload = () => {
        const steps = [{id:'intro1',s:500,e:2500},{id:'intro2',s:2700,e:4700},{id:'intro3',s:4900,e:6900}];
        steps.forEach(st => {
            setTimeout(() => document.getElementById(st.id).classList.add('active'), st.s);
            setTimeout(() => { document.getElementById(st.id).classList.remove('active'); document.getElementById(st.id).style.opacity='0'; }, st.e);
        });
        setTimeout(() => {
            document.getElementById('intro-container').style.display='none';
            const app = document.getElementById('app-content');
            app.style.display='block'; setTimeout(() => app.style.opacity='1', 50);
        }, 7500);
    };

    function setTheme(t) {
        document.body.className = 'theme-' + t;
        const colors = {
            gold:   ['#d4af37', 'linear-gradient(145deg, #f9e27d, #d4af37)'],
            lime:   ['#32CD32', 'linear-gradient(145deg, #7FFF00, #32CD32)'],
            silver: ['#c0c0c0', 'linear-gradient(145deg, #ffffff, #c0c0c0)'],
            cyan:   ['#00ffff', 'linear-gradient(145deg, #e0ffff, #00ffff)'],
            cherry: ['#C511A4', 'linear-gradient(145deg, #FF1493, #C511A4)']
        };
        root.style.setProperty('--main-color', colors[t][0]);
        root.style.setProperty('--main-gradient', colors[t][1]);
        root.style.setProperty('--cell-text', colors[t][0]);
        tg.HapticFeedback.impactOccurred('medium');
        document.querySelector('.theme-panel').classList.remove('open');
    }

    function updateTicketCount(val) {
        let newCount = ticketCount + val;
        if(newCount >= 1) {
            ticketCount = newCount;
            document.getElementById('ticket-count').innerText = ticketCount;
            document.getElementById('total-price').innerText = (ticketCount * PREIS_PRO_TICKET).toFixed(2);
            tg.HapticFeedback.selectionChanged();
        }
    }
</script>
</body>
</html>
