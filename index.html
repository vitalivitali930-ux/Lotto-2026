<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Lotto - –î–≤–∏–∂–æ–∫ VCHF Ultimate 2.0</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { 
            /* –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –ú–æ–Ω–æ–ª–∏—Ç–∞ */
            --main-color: #d4af37; 
            --main-gradient: linear-gradient(145deg, #f9e27d, #d4af37);
            --theme-glow: rgba(212, 175, 55, 0.35); 
            --sphere-base: #1a1a1a;
            --white-sphere: radial-gradient(circle at 35% 35%, #444 0%, #1a1a1a 40%, #000 100%);
            --gold-sphere: radial-gradient(circle at 35% 35%, #fff9d6 0%, #f9e27d 30%, #d4af37 60%, #8a6d1c 100%);
            --cell-text: #ffffff; 
            --hot-color: #ff4500;
            --cold-color: #1e90ff;
            --process-color: #00ffff;
            --neon-blue: #00a3ff;
            /* –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –ò–Ω—Ç—Ä–æ */
            --gold: #ffcc00;
            --onyx: #050505;
            --neon: #00f3ff;
        } 

        body, html { 
            background: #000; 
            color: #fff; 
            font-family: -apple-system, sans-serif; 
            text-align: center; 
            margin: 0; 
            padding: 0;
            overflow: hidden; 
            transition: background 0.5s ease;
            width: 100%; 
            height: 100%;
        } 

        /* –°—Ç–∏–ª–∏ –ò–Ω—Ç—Ä–æ (Canvas Engine) */
        #introCanvas { 
            position: absolute; 
            top: 0; 
            left: 0; 
            z-index: 20001; 
            pointer-events: none; 
        }

        #ui-layer {
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%;
            z-index: 20002; 
            display: flex; 
            flex-direction: column;
            justify-content: center; 
            align-items: center;
            background: radial-gradient(circle, transparent 20%, rgba(0,0,0,0.9) 100%);
            pointer-events: none; 
            transition: opacity 1s ease;
        }

        .logo-box-intro {
            width: 130px; 
            height: 130px; 
            opacity: 0;
            transition: opacity 3s cubic-bezier(0.4, 0, 0.2, 1);
            margin-bottom: 25px;
        }

        .logo-box-intro img { 
            width: 100%; 
            filter: drop-shadow(0 0 20px var(--gold)); 
        }

        .status-label-intro {
            font-family: 'Orbitron', sans-serif;
            color: var(--neon); 
            font-size: 10px;
            letter-spacing: 6px; 
            text-transform: uppercase;
            text-align: center; 
            height: 20px;
            text-shadow: 0 0 10px var(--neon);
        }

        /* –¢–µ–º—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ - –ü—Ä–æ—Ç–æ–∫–æ–ª –≠–¥–µ–ª—å–≤–µ–π—Å */
        body.theme-cherry { 
            --main-color: #C511A4; 
            --main-gradient: linear-gradient(145deg, #FF1493, #C511A4); 
            --theme-glow: rgba(197, 17, 164, 0.35); 
        }

        body.theme-silver { 
            --main-color: #c0c0c0; 
            --main-gradient: linear-gradient(145deg, #e0e0e0, #c0c0c0); 
            --theme-glow: rgba(192, 192, 192, 0.35); 
        }

        body.theme-lime { 
            --main-color: #32CD32; 
            --main-gradient: linear-gradient(145deg, #adff2f, #32CD32); 
            --theme-glow: rgba(50, 205, 50, 0.35); 
        }

        body.theme-cyan { 
            --main-color: #00ffff; 
            --main-gradient: linear-gradient(145deg, #e0ffff, #00ffff); 
            --theme-glow: rgba(0, 255, 255, 0.35); 
        }

        body.theme-gold { 
            --main-color: #d4af37; 
            --main-gradient: linear-gradient(145deg, #f9e27d, #d4af37); 
            --theme-glow: rgba(212, 175, 55, 0.35); 
        }
        /* –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –¶–í–ï–¢–ù–û–ï –î—ã—Ö–∞–Ω–∏–µ */
        @keyframes sphere-breathe {
            0%, 100% { 
                box-shadow: inset -3px -3px 8px rgba(0,0,0,0.8), 0 5px 12px rgba(0,0,0,0.6), 0 0 5px var(--main-color);
                border-color: rgba(255, 255, 255, 0.1); 
                transform: scale(1);
            }
            50% { 
                box-shadow: inset -3px -3px 8px rgba(0,0,0,0.8), 0 5px 22px rgba(0,0,0,0.4), 0 0 20px var(--main-color); 
                border-color: var(--main-color); 
                transform: scale(1.04); 
            }
        }

        @keyframes processing-flash {
            0% { 
                background: var(--process-color); 
                box-shadow: 0 0 25px var(--process-color); 
                transform: scale(1.15); 
            }
            100% { 
                background: var(--white-sphere); 
                box-shadow: none; 
                transform: scale(1); 
            }
        }

        .cell.processing-flash { 
            animation: processing-flash 0.15s ease-out; 
            z-index: 5; 
        }

        @keyframes candle-glow {
            0%, 100% { 
                opacity: 0.6; 
                transform: scale(1); 
                filter: drop-shadow(0 0 5px var(--main-color)); 
            }
            50% { 
                opacity: 1; 
                transform: scale(1.15); 
                filter: drop-shadow(0 0 15px var(--main-color)); 
            }
        }

        .candle { 
            animation: candle-glow 2s infinite ease-in-out; 
        } 

        #legal-overlay {
            position: fixed; 
            inset: 0; 
            background: rgba(0,0,0,0.92); 
            backdrop-filter: blur(15px); 
            z-index: 30000;
            display: none; 
            flex-direction: column; 
            justify-content: center; 
            align-items: center; 
            padding: 25px;
        }

        .legal-box {
            background: #111; 
            border: 2px solid var(--main-color);
            padding: 30px; 
            border-radius: 25px; 
            max-width: 320px; 
            text-align: center;
            box-shadow: 0 0 50px rgba(0,0,0,0.9), 0 0 20px var(--theme-glow);
        } 

        .lang-panel { 
            position: relative; 
            height: 65px; 
            margin-bottom: 25px; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            z-index: 1001; 
        }

        .lang-btn { 
            font-size: 30px; 
            cursor: pointer; 
            position: absolute; 
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
            z-index: 5; 
        }
        
        .pos-ru { transform: translate(-100px, 45px); }
        .pos-fr { transform: translate(-50px, 70px); }
        .pos-de { transform: translate(0px, 80px); }
        .pos-en { transform: translate(50px, 70px); }
        .pos-ua { transform: translate(100px, 45px); } 

        #app-content { 
            display: none; 
            opacity: 0; 
            transition: opacity 1s ease; 
            height: 100vh; 
            overflow: hidden; 
        }

        .page { 
            height: calc(100vh - 75px); 
            overflow-y: auto; 
            display: none; 
            padding: 15px 0 30px; 
        }

        .page.active { 
            display: block; 
        } 
        .nav-bar {
            position: fixed; 
            bottom: 0; 
            left: 0; 
            right: 0; 
            height: 70px;
            background: rgba(10,10,10,0.95); 
            display: flex; 
            justify-content: space-around;
            align-items: center; 
            border-top: 1.5px solid var(--main-color); 
            z-index: 1000;
        }

        .nav-item { 
            color: #666; 
            font-size: 10px; 
            cursor: pointer; 
            transition: 0.3s; 
        }

        .nav-item.active { 
            color: var(--main-color); 
            transform: translateY(-3px); 
        }

        .nav-item span { 
            display: block; 
            font-size: 24px; 
            margin-bottom: 2px; 
        } 

        .balance-container { 
            display: flex; 
            gap: 10px; 
            padding: 0 15px 15px; 
        }

        .bal-card { 
            flex: 1; 
            border-radius: 12px; 
            padding: 12px; 
            background: linear-gradient(145deg, #1a1a1a, #0a0a0a); 
            border: 1.5px solid #444; 
            transition: all 0.4s ease; 
            cursor: pointer; 
            opacity: 0.5; 
            filter: grayscale(0.7) brightness(0.8);
        }

        .bal-card.active-wallet { 
            opacity: 1; 
            filter: grayscale(0) brightness(1.2); 
            border-color: var(--main-color); 
            background: rgba(255, 255, 255, 0.07); 
            box-shadow: 0 0 15px var(--main-color); 
            transform: scale(1.05); 
        }

        .bal-val { 
            font-size: 20px; 
            font-weight: bold; 
            color: #32CD32; 
        } 

        .grid { 
            display: grid; 
            grid-template-columns: repeat(7, 1fr); 
            gap: 10px; 
            padding: 0 15px; 
            max-width: 400px; 
            margin: 0 auto; 
        }

        .cell { 
            aspect-ratio: 1/1; 
            background: var(--white-sphere); 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center;
            font-weight: 800; 
            color: var(--cell-text); 
            font-size: 19px; 
            transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
            cursor: pointer; 
            position: relative; 
            border: 1px solid rgba(255,255,255,0.1);
            animation: sphere-breathe 4s infinite ease-in-out;
        }

        .cell.selected { 
            background: var(--main-gradient); 
            color: #000; 
            transform: scale(1.1) translateY(-5px); 
            box-shadow: 0 10px 25px rgba(0,0,0,0.5), 0 0 30px var(--main-color); 
            border: 2px solid #fff; 
            z-index: 10; 
            animation: none; 
        }
        .ticket-card { 
            background: rgba(255,255,255,0.05); 
            border: 1.2px solid #333; 
            border-radius: 16px; 
            padding: 15px; 
            margin: 0 15px 12px; 
            text-align: left; 
        }

        .ticket-nums { 
            display: flex; 
            gap: 8px; 
            margin: 10px 0; 
            flex-wrap: wrap; 
        }

        .mini-ball { 
            width: 30px; 
            height: 30px; 
            background: #000; 
            border: 1px solid var(--main-color); 
            border-radius: 50%; 
            color: #fff; 
            font-size: 14px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-weight: 800; 
        }

        .super-ball-mini { 
            background: #ff4500 !important; 
            color: #fff !important; 
            border: none; 
        } 

        .ticket-controls { 
            margin-bottom: 20px; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            gap: 12px; 
        }

        .smart-tools { 
            display: flex; 
            gap: 8px; 
            flex-wrap: wrap; 
            justify-content: center; 
        }

        .tool-btn { 
            padding: 8px 15px; 
            border-radius: 20px; 
            border: 1px solid var(--main-color); 
            background: rgba(0,0,0,0.6); 
            color: #fff; 
            font-size: 11px; 
            cursor: pointer; 
            transition: 0.3s; 
        }

        .tool-btn.active-tool { 
            background: var(--main-color); 
            color: #000; 
            font-weight: bold; 
        }
        
        .stats-period { 
            display: flex; 
            justify-content: center; 
            gap: 5px; 
            height: 30px; 
        }

        .p-btn { 
            font-size: 10px; 
            padding: 4px 10px; 
            border-radius: 12px; 
            border: 1px solid #444; 
            background: #222; 
            color: #888; 
            cursor: pointer; 
        }

        .p-btn.active { 
            border-color: var(--main-color); 
            color: #fff; 
            box-shadow: 0 0 10px var(--main-color); 
        } 

        .counter-box { 
            display: flex; 
            align-items: center; 
            gap: 15px; 
            background: rgba(255,255,255,0.1); 
            padding: 10px 20px; 
            border-radius: 25px; 
            border: 1px solid var(--main-color); 
        }

        .btn-round { 
            width: 35px; 
            height: 35px; 
            border-radius: 50%; 
            border: 1.5px solid var(--main-color); 
            background: none; 
            color: #fff; 
            font-size: 20px; 
            cursor: pointer; 
        } 

        .total-display { 
            margin: 15px 0; 
            font-size: 18px; 
            color: #fff; 
        }

        #display-total { 
            color: var(--neon-blue); 
            font-weight: 900; 
        } 
        .super-title { 
            margin: 25px 0 10px; 
            font-size: 14px; 
            color: var(--main-color); 
            font-weight: bold; 
            text-transform: uppercase; 
        }

        .super-grid { 
            display: flex; 
            justify-content: center; 
            gap: 12px; 
            padding-bottom: 20px; 
        }

        .super-cell { 
            width: 58px; 
            height: 58px; 
            background: var(--white-sphere); 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            color: var(--cell-text); 
            font-weight: 900; 
            font-size: 24px; 
            cursor: pointer; 
            transition: 0.4s; 
            border: 1px solid rgba(255,255,255,0.1);
            animation: sphere-breathe 4s infinite ease-in-out;
        }

        .super-cell.selected { 
            transform: scale(1.2); 
            background: var(--main-gradient); 
            color: #000; 
            border: 2px solid #fff; 
            box-shadow: 0 0 30px var(--main-color); 
            animation: none; 
        } 

        .theme-toggle { 
            position: fixed; 
            top: 15px; 
            right: 15px; 
            font-size: 26px; 
            z-index: 1001; 
            cursor: pointer; 
        }

        .theme-panel { 
            position: fixed; 
            top: 65px; 
            right: 15px; 
            display: flex; 
            flex-direction: column; 
            gap: 15px; 
            z-index: 1000; 
            background: rgba(0,0,0,0.95); 
            padding: 15px; 
            border-radius: 25px; 
            border: 1px solid var(--main-color); 
            transition: 0.3s; 
            transform: translateX(120px); 
        }

        .theme-panel.open { 
            transform: translateX(0); 
        }

        .dot { 
            width: 32px; 
            height: 32px; 
            border-radius: 50%; 
            border: 2px solid #fff; 
            cursor: pointer; 
        } 

        .btn-main { 
            width: 85%; 
            padding: 22px; 
            border-radius: 18px; 
            font-size: 20px; 
            margin-top: 10px; 
            background: var(--main-gradient); 
            color: #000; 
            border: none; 
            font-weight: 800; 
            cursor: pointer; 
        }
        
        @keyframes pulse-hot { 
            from { box-shadow: 0 0 15px #ff4500; transform: scale(1.02); } 
            to { box-shadow: 0 0 30px #ff4500; transform: scale(1.1); } 
        }
        @keyframes pulse-cold { 
            from { box-shadow: 0 0 15px #1e90ff; transform: scale(1.02); } 
            to { box-shadow: 0 0 30px #1e90ff; transform: scale(1.1); } 
        }

        .cell.is-hot { 
            border: 3px solid #ff4500 !important; 
            box-shadow: 0 0 25px #ff4500 !important; 
            animation: pulse-hot 1.2s 3 alternate; 
            z-index: 5; 
        }

        .cell.is-cold { 
            border: 3px solid #1e90ff !important; 
            box-shadow: 0 0 25px #1e90ff !important; 
            animation: pulse-cold 1.2s 3 alternate; 
            z-index: 5; 
        }

        .cell.is-sleeping { 
            border: 3px solid var(--process-color) !important; 
            box-shadow: 0 0 25px var(--process-color) !important; 
            animation: pulse-hot 1.2s 3 alternate; 
        }
    </style>
</head>
<body> 
<div id="legal-overlay">
    <div class="legal-box">
        <div id="legal-content" style="font-size: 14px; line-height: 1.6; margin-bottom: 25px; color: #eee;"></div>
        <button class="btn-main" onclick="acceptLegal()" id="legal-agree-btn" style="width:100%; margin-top:0; padding:15px;"></button>
    </div>
</div> 

<canvas id="introCanvas"></canvas>
<div id="ui-layer">
    <div id="mainLogoIntro" class="logo-box-intro">
        <img src="1771489965074(1).png" alt="Logo">
    </div>
    <div id="mainStatusIntro" class="status-label-intro">INITIALIZING ENGINE...</div>
</div>

<div id="app-content">
    <div id="page-play" class="page active">
        <div class="lang-panel" id="dynamic-langs"></div>
        <div class="theme-toggle" onclick="document.querySelector('.theme-panel').classList.toggle('open')">üé®</div>
        <div class="theme-panel">
            <div class="dot" style="background: #d4af37;" onclick="setTheme('gold')"></div>
            <div class="dot" style="background: #32CD32;" onclick="setTheme('lime')"></div>
            <div class="dot" style="background: #00ffff;" onclick="setTheme('cyan')"></div>
            <div class="dot" style="background: #C511A4;" onclick="setTheme('cherry')"></div>
            <div class="dot" style="background: #c0c0c0;" onclick="setTheme('silver')"></div>
        </div> 

        <div class="balance-container">
            <div class="bal-card active-wallet" id="card-vchf" onclick="switchCurrency('VCHF')">
                <div style="font-size:10px;">VIRTUAL VCHF</div>
                <div class="bal-val" id="vchf-val">100.00</div>
            </div>
            <div class="bal-card" id="card-chf" onclick="switchCurrency('CHF')">
                <div style="font-size:10px;">REAL CHF</div>
                <div class="bal-val" id="chf-val">0.00</div>
            </div>
        </div> 

        <div class="ticket-controls">
            <div class="smart-tools">
                <button class="tool-btn" onclick="togglePick('hot')" id="btn-hot">üî• HOT</button>
                <button class="tool-btn" onclick="togglePick('cold')" id="btn-cold">‚ùÑÔ∏è COLD</button>
                <button class="tool-btn" onclick="togglePick('sleeping')" id="btn-sleeping">üí§ SLEEPING</button>
                <button class="tool-btn" onclick="randomFill()">üé≤ RANDOM</button>
            </div>
            <div class="stats-period" id="stats-p-box">
                <button class="p-btn active" onclick="setPeriod('month')" id="p-month">MONTH</button>
                <button class="p-btn" onclick="setPeriod('year')" id="p-year">YEAR</button>
                <button class="p-btn" onclick="setPeriod('all')" id="p-all">ALL TIME</button>
            </div>
            <div class="counter-box">
                <button class="btn-round" onclick="updateTicketCount(-1)">‚àí</button>
                <span style="font-size: 20px; font-weight: bold;"><span id="ticket-count">1</span> √ó</span>
                <button class="btn-round" onclick="updateTicketCount(1)">+</button>
            </div>
        </div> 

        <div class="grid" id="main-grid"></div>
        <div id="l-super" class="super-title">SUPERZAHL</div>
        <div class="super-grid" id="s-grid"></div>
        <div class="total-display">
            <span id="l-total">Total</span>: <span id="display-total">2.50 VCHF</span>
        </div>
        <button class="btn-main" id="main-btn" onclick="runEngine()">TICKET BEST√ÑTIGEN</button>
    </div> 

    <div id="page-tickets" class="page">
        <h2 id="l-active-tickets-title" style="color: var(--main-color);">MEINE TICKETS</h2>
        <div id="active-list"></div>
    </div> 
    <div id="page-stats" class="page">
        <h2 id="l-personal-stats-title" style="color: var(--main-color);">STATISTIK</h2>
        <div class="grid" id="personal-heatmap"></div>
    </div> 
    <div class="nav-bar">
        <div class="nav-item active" onclick="showPage('play', this)"><span>üé≤</span><label id="n-game">SPIEL</label></div>
        <div class="nav-item" onclick="showPage('tickets', this)"><span>üéüÔ∏è</span><label id="n-tickets">TICKETS</label></div>
        <div class="nav-item" onclick="showPage('stats', this)"><span>üìä</span><label id="n-stats">STATS</label></div>
    </div>
</div> 

<script>
    /* –ú–∞–Ω–∏—Ñ–µ—Å—Ç –ú–æ–Ω–æ–ª–∏—Ç–∞: –î–≤–∏–∂–æ–∫ VCHF */
    const canvas = document.getElementById('introCanvas');
    const ctx = canvas.getContext('2d');
    const statusIntro = document.getElementById('mainStatusIntro');
    const logoIntro = document.getElementById('mainLogoIntro');
    const tg = window.Telegram.WebApp; 
    tg.expand(); 

    const sndClick = new Audio('https://www.soundjay.com/buttons/sounds/button-16.mp3');
    const sndShuffle = new Audio('https://www.soundjay.com/misc/sounds/marbles-shake-1.mp3');
    const sndWin = new Audio('https://www.soundjay.com/buttons/sounds/button-09.mp3'); 

    let realStatsDB = {};
    let myTickets = JSON.parse(localStorage.getItem('vchf_user_tickets')) || [];
    let selected = [], superNum = null, currentPeriod = 'month', ticketCount = 1, currentCurrency = 'VCHF', currentLang = 'en', pendingLang = 'en', bgsTimer = null;
    let activeSmartTool = null; 
    const realPrice = 2.50; 

    const dict = {
        ru: { btn: "–ü–û–î–¢–í–ï–†–î–ò–¢–¨", super: "–ë–û–ù–£–°–ù–û–ï –ß–ò–°–õ–û", month: "–ú–ï–°–Ø–¶", year: "–ì–û–î", all: "–ó–ê –í–°–Å –í–†–ï–ú–Ø", total: "–ò—Ç–æ–≥–æ", status: "–°—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–ª—ë–Ω!", game: "–ò–ì–†–ê", tickets: "–ë–ò–õ–ï–¢–´", stats: "–°–¢–ê–¢–°", activeT: "–ú–û–ò –ë–ò–õ–ï–¢–´", hit: "–õ–ò–ß–ù–ê–Ø –ö–ê–†–¢–ê", del: "–£–î–ê–õ–ò–¢–¨", lock: "–ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù–û" },
        ua: { btn: "–ü–Ü–î–¢–í–ï–†–î–ò–¢–ò", super: "–ë–û–ù–£–°–ù–ï –ß–ò–°–õ–û", month: "–ú–Ü–°–Ø–¶–¨", year: "–†–Ü–ö", all: "–ó–ê –í–ï–°–¨ –ß–ê–°", total: "–†–∞–∑–æ–º", status: "–°—Ç–∞—Ç—É—Å –æ–Ω–æ–≤–ª–µ–Ω–æ!", game: "–ì–†–ê", tickets: "–ö–í–ò–¢–ö–ò", stats: "–°–¢–ê–¢–°", activeT: "–ú–û–á –ö–í–ò–¢–ö–ò", hit: "–û–°–û–ë–ò–°–¢–ê –ö–ê–†–¢–ê", del: "–í–ò–î–ê–õ–ò–¢–ò", lock: "–ó–ê–ë–õ–û–ö–û–í–ê–ù–û" },
        de: { btn: "BEST√ÑTIGEN", super: "SUPERZAHL", month: "MONAT", year: "JAHR", all: "ALLE ZEIT", total: "Gesamt", status: "Status aktualisiert!", game: "SPIEL", tickets: "TICKETS", stats: "STATS", activeT: "MEINE TICKETS", hit: "PERS√ñNLICHE KARTE", del: "L√ñSCHEN", lock: "GESPERRT" },
        en: { btn: "CONFIRM", super: "SUPER NUMBER", month: "MONTH", year: "YEAR", all: "ALL TIME", total: "Total", status: "Status updated!", game: "GAME", tickets: "TICKETS", stats: "STATS", activeT: "MY TICKETS", hit: "PERSONAL MAP", del: "DELETE", lock: "LOCKED" },
        fr: { btn: "CONFIRMER", super: "SUPER NOMBRE", month: "MOIS", year: "AN", all: "TOUT LE TEMPS", total: "Total", status: "Statut mis √† jour!", game: "JEU", tickets: "BILLETS", stats: "STATS", activeT: "MES BILLETS", hit: "CARTE PERSO", del: "SUPPRIMER", lock: "VERROUILL√â" }
    }; 

    const legalDict = {
        ru: { title: "–ó–∞–∫–æ–Ω –®–≤–µ–π—Ü–∞—Ä–∏–∏ (BGS)", text: "–°–æ–≥–ª–∞—Å–Ω–æ –§–µ–¥–µ—Ä–∞–ª—å–Ω–æ–º—É –∑–∞–∫–æ–Ω—É –®–≤–µ–π—Ü–∞—Ä–∏–∏ –æ–± –∞–∑–∞—Ä—Ç–Ω—ã—Ö –∏–≥—Ä–∞—Ö (BGS), —É—á–∞—Å—Ç–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ —Ç–æ–ª—å–∫–æ –ª–∏—Ü–∞–º —Å—Ç–∞—Ä—à–µ <b>18 –ª–µ—Ç</b>. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —Å–≤–æ—ë —Å–æ–≥–ª–∞—Å–∏–µ.", btn: "–ú–ù–ï –ï–°–¢–¨ 18 –õ–ï–¢" },
        ua: { title: "–ó–∞–∫–æ–Ω –®–≤–µ–π—Ü–∞—Ä—ñ—ó (BGS)", text: "–ó–≥—ñ–¥–Ω–æ –∑ –§–µ–¥–µ—Ä–∞–ª—å–Ω–∏–º –∑–∞–∫–æ–Ω–æ–º –®–≤–µ–π—Ü–∞—Ä—ñ—ó –ø—Ä–æ –∞–∑–∞—Ä—Ç–Ω—ñ —ñ–≥—Ä–∏ (BGS), —É—á–∞—Å—Ç–∏–µ –¥–æ–∑–≤–æ–ª–µ–Ω–∞ –ª–∏—à–µ –æ—Å–æ–±–∞–º —Å—Ç–∞—Ä—à–µ <b>18 —Ä–æ–∫—ñ–≤</b>. –ü—ñ–¥—Ç–≤–µ—Ä–¥—å—Ç–µ —Å–≤–æ—é –∑–≥–æ–¥—É.", btn: "–ú–ï–ù–Ü –Ñ 18 –†–û–ö–Ü–í" },
        de: { title: "Schweizer Gesetz (BGS)", text: "Gem√§ss dem Bundesgesetz √ºber Geldspiele (BGS) ist die Teilnahme erst ab <b>18 Jahren</b> gestattet. Best√§tigen Sie Ihr Einverst√§ndnis.", btn: "ICH BIN 18 JAHRE ALT" },
        en: { title: "Swiss Law (BGS)", text: "According to the Swiss Federal Act on Gambling (BGS), participation is only allowed for persons over <b>18 years</b> old. Please confirm your agreement.", btn: "I AM 18 YEARS OLD" },
        fr: { title: "Loi Suisse (BGS)", text: "Selon la Loi f√©d√©rale sur les jeux d'argent (BGS), la participation est r√©serv√©e aux personnes de plus de <b>18 ans</b>. Veuillez confirmer votre accord.", btn: "J'AI 18 ANS" }
    };

    const spheresIntro = [
        { x: 0.15, y: 0.25, colors: ['#000', '#ffcc00', '#000'], label: 'DE' },
        { x: 0.85, y: 0.25, colors: ['#eee', '#ffffff', '#eee'], label: 'EN' },
        { x: 0.15, y: 0.50, colors: ['#0057b7', '#ffd700'], label: 'UA' },
        { x: 0.85, y: 0.50, colors: ['#fff', '#0039a6', '#d52b1e'], label: 'RU' },
        { x: 0.15, y: 0.75, colors: ['#002395', '#ffffff', '#ed2939'], label: 'FR' },
        { x: 0.85, y: 0.75, colors: ['#008c45', '#f4f5f0', '#cd212a'], label: 'IT' }
    ];
    let drawnItems = spheresIntro.map(s => ({ ...s, grow: 0, ink: 0 }));
    let l1 = { x: window.innerWidth/2, y: 0 }, l2 = { x: window.innerWidth/2, y: window.innerHeight };
    let step1 = 0, step2 = 0, active2 = false, fadeIntro = 1.0;

    function drawSphereIntro(s) {
        if (s.grow <= 0) return;
        const x = s.x * canvas.width, y = s.y * canvas.height, r = 42 * s.grow;
        ctx.shadowBlur = 30; ctx.shadowColor = 'rgba(0,0,0,1)';
        ctx.fillStyle = '#000'; ctx.beginPath(); ctx.arc(x, y, r, 0, 7); ctx.fill(); ctx.shadowBlur = 0;
        let gBody = ctx.createRadialGradient(x-15, y-15, r/10, x, y, r);
        gBody.addColorStop(0, '#fff'); gBody.addColorStop(0.5, '#444'); gBody.addColorStop(1, '#050505');
        ctx.fillStyle = gBody; ctx.beginPath(); ctx.arc(x, y, r, 0, 7); ctx.fill();
        if (s.ink > 0) {
            ctx.save(); ctx.beginPath(); ctx.arc(x, y, r-2, 0, 7); ctx.clip();
            let gFlag = ctx.createLinearGradient(x-r, y-r, x+r, y+r);
            s.colors.forEach((c, i) => gFlag.addColorStop(i/(s.colors.length-1), c));
            ctx.globalAlpha = s.ink; ctx.fillStyle = gFlag; ctx.fill(); ctx.restore(); ctx.globalAlpha = 1;
        }
        let gGlass = ctx.createRadialGradient(x-15, y-15, 2, x-10, y-10, r);
        gGlass.addColorStop(0, 'rgba(255,255,255,0.9)'); gGlass.addColorStop(0.3, 'rgba(255,255,255,0.1)'); gGlass.addColorStop(1, 'rgba(0,0,0,0.5)');
        ctx.fillStyle = gGlass; ctx.beginPath(); ctx.arc(x, y, r, 0, 7); ctx.fill();
    }

    function animateIntro() {
        if (fadeIntro <= 0.01) {
            document.getElementById('ui-layer').style.display = 'none';
            canvas.style.display = 'none';
            document.getElementById('app-content').style.display = 'block';
            setTimeout(() => document.getElementById('app-content').style.opacity = '1', 50);
            return;
        }
        ctx.clearRect(0,0, canvas.width, canvas.height);
        ctx.globalAlpha = fadeIntro;
        if (step1 < spheresIntro.length) {
            let target = drawnItems[step1]; let tx = target.x * canvas.width, ty = target.y * canvas.height;
            ctx.beginPath(); ctx.moveTo(canvas.width/2, 0); ctx.lineTo(l1.x, l1.y);
            ctx.strokeStyle = '#00f3ff'; ctx.lineWidth = 1; ctx.stroke();
            l1.x += (tx - l1.x) * 0.08; l1.y += (ty - l1.y) * 0.08;
            if (Math.abs(l1.x-tx)<2) { if (target.grow < 1) target.grow += 0.04; else step1++; }
        }
        if (active2 && step2 < spheresIntro.length) {
            let target = drawnItems[step2]; let tx = target.x * canvas.width, ty = target.y * canvas.height;
            ctx.beginPath(); ctx.moveTo(canvas.width/2, canvas.height); ctx.lineTo(l2.x, l2.y);
            ctx.strokeStyle = '#ffcc00'; ctx.lineWidth = 1.5; ctx.stroke();
            l2.x += (tx - l2.x) * 0.08; l2.y += (ty - l2.y) * 0.08;
            if (Math.abs(l2.x-tx)<2) { if (target.ink < 1) target.ink += 0.03; else step2++; }
        }
        drawnItems.forEach(drawSphereIntro);
        if (step2 === spheresIntro.length) {
            statusIntro.innerText = "GLOBAL LOTTO POOL"; statusIntro.style.color = "var(--gold)";
            setTimeout(() => { fadeIntro -= 0.01; document.getElementById('ui-layer').style.opacity = fadeIntro; }, 2000);
        }
        requestAnimationFrame(animateIntro);
    }

    function renderLangPanel(isExpanded) {
        const container = document.getElementById('dynamic-langs'); container.innerHTML = '';
        const main = document.createElement('span'); main.className = 'lang-btn' + (!localStorage.getItem('vchf_lang') ? ' candle' : '');
        main.innerHTML = (currentLang === 'en' ? 'üá∫üá∏' : currentLang === 'ru' ? 'üá∑üá∫' : currentLang === 'ua' ? 'üá∫üá¶' : currentLang === 'de' ? 'üá©üá™' : 'üá´üá∑');
        main.onclick = () => { renderLangPanel(!isExpanded); tg.HapticFeedback.impactOccurred('light'); };
        container.appendChild(main);
        if (isExpanded) {
            const order = ['ru', 'fr', 'de', 'en', 'ua']; const icons = { ru:'üá∑üá∫', fr:'üá´üá∑', de:'üá©üá™', en:'üá∫üá∏', ua:'üá∫üá¶' };
            order.forEach(l => {
                const btn = document.createElement('span'); btn.className = `lang-btn pos-${l}`; btn.innerHTML = icons[l];
                btn.onclick = () => selectLang(l); container.appendChild(btn);
            });
        }
    }
    function selectLang(l) { if (bgsTimer) clearTimeout(bgsTimer); pendingLang = l; showLegal(l); }
    function showLegal(l) {
        const overlay = document.getElementById('legal-overlay'); const content = document.getElementById('legal-content');
        content.innerHTML = `<h3 style="color:var(--main-color);margin-top:0;">${legalDict[l].title}</h3>${legalDict[l].text}`;
        document.getElementById('legal-agree-btn').innerText = legalDict[l].btn;
        overlay.style.display = 'flex'; document.getElementById('app-content').style.filter = 'blur(10px)';
    }
    function acceptLegal() {
        currentLang = pendingLang; localStorage.setItem('vchf_lang', currentLang); localStorage.setItem('vchf_legal_accepted', 'true');
        document.getElementById('legal-overlay').style.display = 'none'; document.getElementById('app-content').style.filter = 'none';
        setLang(currentLang); renderLangPanel(false); tg.HapticFeedback.notificationOccurred('success');
    }
    function togglePick(type) {
        activeSmartTool = type; document.querySelectorAll('.tool-btn').forEach(b => b.classList.remove('active-tool'));
        if (document.getElementById(`btn-${type}`)) document.getElementById(`btn-${type}`).classList.add('active-tool');
        selected = []; document.querySelectorAll('.cell').forEach(c => { c.classList.remove('is-hot', 'is-cold', 'is-sleeping', 'selected'); c.style.animation = 'none'; });
        const pIdx = currentPeriod === 'month' ? 0 : currentPeriod === 'year' ? 1 : 2;
        let sorted = Object.keys(realStatsDB).map(n => ({ num: parseInt(n), val: realStatsDB[n][pIdx] }));
        if (type === 'hot') sorted.sort((a, b) => b.val - a.val); else sorted.sort((a, b) => a.val - b.val);
        selected = sorted.slice(0, 6).map(i => i.num);
        selected.forEach(n => { const el = document.getElementById(`cell-${n}`); if (el) el.classList.add('selected', `is-${type}`); });
        superNum = Math.floor(Math.random() * 6) + 1;
        document.querySelectorAll('.super-cell').forEach((sc, idx) => sc.classList.toggle('selected', idx + 1 === superNum));
        sndWin.play();
    }
    function showPage(pId, el) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        document.getElementById('page-' + pId).classList.add('active'); el.classList.add('active');
        if(pId === 'tickets') renderTickets(); if(pId === 'stats') renderHeatmap();
    }
    function renderTickets() {
        const container = document.getElementById('active-list'); container.innerHTML = '';
        myTickets.forEach(t => {
            const card = document.createElement('div'); card.className = 'ticket-card';
            card.innerHTML = `<div style="font-size:11px;color:#888;">ID: ${t.timestamp}</div><div class="ticket-nums">${t.nums.map(n => `<div class="mini-ball">${n}</div>`).join('')}<div class="mini-ball super-ball-mini">${t.super}</div></div>`;
            container.appendChild(card);
        });
    }
    function renderHeatmap() {
        const grid = document.getElementById('personal-heatmap'); grid.innerHTML = '';
        for(let i=1; i<=42; i++) {
            const c = document.createElement('div'); c.className = 'cell'; c.innerText = i;
            if(realStatsDB[i][2] > 450) c.style.boxShadow = `inset 0 0 15px var(--main-color)`;
            grid.appendChild(c);
        }
    }
    function setLang(l) {
        currentLang = l; const d = dict[l]; document.getElementById('main-btn').innerText = d.btn;
        document.getElementById('l-super').innerText = d.super; document.getElementById('l-total').innerText = d.total;
        ['month', 'year', 'all'].forEach(p => document.getElementById(`p-${p}`).innerText = d[p]);
        ['game', 'tickets', 'stats'].forEach(n => document.getElementById(`n-${n}`).innerText = d[n]);
        document.getElementById('l-active-tickets-title').innerText = d.activeT;
        document.getElementById('l-personal-stats-title').innerText = d.stats;
    }
    function handleCellClick(i) {
        sndClick.currentTime = 0; sndClick.play(); activeSmartTool = null; 
        document.querySelectorAll('.tool-btn').forEach(b => b.classList.remove('active-tool'));
        if(selected.includes(i)) selected = selected.filter(n => n !== i); else if(selected.length < 6) selected.push(i);
        refreshGrid();
    }
    function refreshGrid() {
        const grid = document.getElementById('main-grid'); grid.innerHTML = '';
        for (let i = 1; i <= 42; i++) {
            const c = document.createElement('div'); c.className = 'cell'; c.id = `cell-${i}`; c.innerText = i;
            if (selected.includes(i)) { c.classList.add('selected'); c.style.animation = 'none'; }
            else { c.style.animation = 'sphere-breathe 4s infinite ease-in-out'; c.style.animationDelay = `${(Math.random()*2).toFixed(2)}s`; }
            c.onclick = () => handleCellClick(i); grid.appendChild(c);
        }
    }
    function randomFill() {
        activeSmartTool = null; selected = []; sndShuffle.play();
        let it = 0; const iv = setInterval(() => {
            document.querySelectorAll('.cell').forEach(c => c.classList.remove('processing-flash'));
            for(let j=0; j<4; j++) { const r = Math.floor(Math.random()*42)+1; document.getElementById(`cell-${r}`).classList.add('processing-flash'); }
            if (it % 3 === 0 && selected.length < 6) { let r; do { r=Math.floor(Math.random()*42)+1; } while(selected.includes(r)); selected.push(r); refreshGrid(); }
            if (++it >= 20) { clearInterval(iv); superNum = Math.floor(Math.random()*6)+1; refreshGrid(); 
                document.querySelectorAll('.super-cell').forEach((sc, idx) => sc.classList.toggle('selected', idx+1===superNum)); sndWin.play(); }
        }, 85);
    }
    function updateTicketCount(v) { ticketCount = Math.max(1, ticketCount + v); document.getElementById('ticket-count').innerText = ticketCount; updatePriceDisplay(); }
    function switchCurrency(t) { currentCurrency = t; document.getElementById('card-vchf').classList.toggle('active-wallet', t === 'VCHF'); document.getElementById('card-chf').classList.toggle('active-wallet', t === 'CHF'); updatePriceDisplay(); }
    function updatePriceDisplay() { document.getElementById('display-total').innerText = `${(ticketCount * realPrice).toFixed(2)} ${currentCurrency}`; }
    function setTheme(t) { document.body.className = 'theme-' + t; const c = {gold:'#d4af37', lime:'#32CD32', silver:'#c0c0c0', cyan:'#00ffff', cherry:'#C511A4'}; document.documentElement.style.setProperty('--main-color', c[t]); refreshGrid(); }
    function setPeriod(p) { currentPeriod = p; document.querySelectorAll('.p-btn').forEach(b => b.classList.toggle('active', b.id === `p-${p}`)); if (activeSmartTool) togglePick(activeSmartTool); }
    function runEngine() { if(selected.length===6 && superNum) { myTickets.push({nums:[...selected], super:superNum, timestamp:new Date().toLocaleString()}); localStorage.setItem('vchf_user_tickets', JSON.stringify(myTickets)); tg.showAlert(dict[currentLang].status); selected=[]; superNum=null; refreshGrid(); } else tg.showAlert("Select 6+1!"); }
    
    window.onload = () => {
        canvas.width = window.innerWidth; canvas.height = window.innerHeight;
        const saved = localStorage.getItem('vchf_lang'); if(saved) { currentLang=saved; setLang(saved); renderLangPanel(false); }
        else { currentLang='en'; renderLangPanel(false); bgsTimer=setTimeout(()=>showLegal('en'), 10000); }
        for(let i=1; i<=42; i++) realStatsDB[i] = [Math.floor(Math.random()*5), Math.floor(Math.random()*20), 300+Math.floor(Math.random()*200)];
        refreshGrid(); updatePriceDisplay();
        const sgrid = document.getElementById('s-grid');
        for(let i=1;i<=6;i++){ const sc=document.createElement('div'); sc.className='super-cell'; sc.innerText=i; sc.onclick=()=>{superNum=i; document.querySelectorAll('.super-cell').forEach(el=>el.classList.toggle('selected', el.innerText==i));}; sgrid.appendChild(sc); }
        setTimeout(() => { logoIntro.style.opacity = '1'; statusIntro.innerText = "HELVETIC LUCK LOADING..."; setTimeout(() => requestAnimationFrame(animateIntro), 2000); setTimeout(() => active2 = true, 3000); }, 1000);
    };
</script>
</body>
</html>
