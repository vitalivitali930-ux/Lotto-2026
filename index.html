<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Lotto - –î–≤–∏–∂–æ–∫ VCHF Bi-Turbo Ultimate 2.0</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { 
            /* –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –ú–æ–Ω–æ–ª–∏—Ç–∞ [cite: 2026-02-24] */
            --main-color: #d4af37; 
            --main-gradient: linear-gradient(145deg, #f9e27d, #d4af37);
            --theme-glow: rgba(212, 175, 55, 0.35); 
            --sphere-base: #1a1a1a;
            --white-sphere: radial-gradient(circle at 35% 35%, #444 0%, #1a1a1a 40%, #000 100%);
            --gold-sphere: radial-gradient(circle at 35% 35%, #fff9d6 0%, #f9e27d 30%, #d4af37 60%, #8a6d1c 100%);
            --cell-text: #ffffff; 
            --hot-color: #ff4500;
            --cold-color: #1e90ff;
            --process-color: #00ffff;
            --neon-blue: #00a3ff;
            /* –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –ò–Ω—Ç—Ä–æ */
            --gold: #ffcc00;
            --onyx: #050505;
            --neon: #00f3ff;
            /* –†–∞–¥—É–∂–Ω—ã–µ –∞–∫—Ü–µ–Ω—Ç—ã Rainbow Wave */
            --lime: #32CD32;
            --cyan: #00ffff;
            --cherry: #C511A4;
            --silver: #c0c0c0;
        } 

        body, html { 
            background: #000; 
            color: #fff; 
            font-family: -apple-system, sans-serif; 
            text-align: center; 
            margin: 0; 
            padding: 0;
            overflow: hidden; 
            transition: background 0.5s ease;
            width: 100%; 
            height: 100%;
        } 

        /* –°—Ç–∏–ª–∏ –ò–Ω—Ç—Ä–æ (Canvas Engine) */
        #introCanvas { 
            position: absolute; 
            top: 0; 
            left: 0; 
            z-index: 20001; 
            pointer-events: none; 
        } 

        #ui-layer {
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%;
            z-index: 20002; 
            display: flex; 
            flex-direction: column;
            justify-content: center; 
            align-items: center;
            background: radial-gradient(circle, transparent 20%, rgba(0,0,0,0.9) 100%);
            pointer-events: none; 
            transition: opacity 1s ease;
        } 

        .logo-box-intro {
            width: 130px; 
            height: 130px; 
            opacity: 0;
            transition: opacity 3s cubic-bezier(0.4, 0, 0.2, 1);
            margin-bottom: 25px;
        } 

        .logo-box-intro img { 
            width: 100%; 
            filter: drop-shadow(0 0 20px var(--gold)); 
        } 

        .status-label-intro {
            font-family: 'Orbitron', sans-serif;
            color: var(--neon); 
            font-size: 10px;
            letter-spacing: 6px; 
            text-transform: uppercase;
            text-align: center; 
            height: 20px;
            text-shadow: 0 0 10px var(--neon);
        } 

        /* –¢–µ–º—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ - –ü—Ä–æ—Ç–æ–∫–æ–ª –≠–¥–µ–ª—å–≤–µ–π—Å */
        body.theme-cherry { 
            --main-color: #C511A4; 
            --main-gradient: linear-gradient(145deg, #FF1493, #C511A4); 
            --theme-glow: rgba(197, 17, 164, 0.35); 
        } 

        body.theme-silver { 
            --main-color: #c0c0c0; 
            --main-gradient: linear-gradient(145deg, #e0e0e0, #c0c0c0); 
            --theme-glow: rgba(192, 192, 192, 0.35); 
        } 

        body.theme-lime { 
            --main-color: #32CD32; 
            --main-gradient: linear-gradient(145deg, #adff2f, #32CD32); 
            --theme-glow: rgba(50, 205, 50, 0.35); 
        } 

        body.theme-cyan { 
            --main-color: #00ffff; 
            --main-gradient: linear-gradient(145deg, #e0ffff, #00ffff); 
            --theme-glow: rgba(0, 255, 255, 0.35); 
        } 

        body.theme-gold { 
            --main-color: #d4af37; 
            --main-gradient: linear-gradient(145deg, #f9e27d, #d4af37); 
            --theme-glow: rgba(212, 175, 55, 0.35); 
        }
        /* –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –¶–í–ï–¢–ù–û–ï –î—ã—Ö–∞–Ω–∏–µ [cite: 2026-02-23] */
        @keyframes sphere-breathe {
            0%, 100% { 
                box-shadow: inset -3px -3px 8px rgba(0,0,0,0.8), 0 5px 12px rgba(0,0,0,0.6), 0 0 5px var(--main-color);
                border-color: rgba(255, 255, 255, 0.1); 
                transform: scale(1);
            }
            50% { 
                box-shadow: inset -3px -3px 8px rgba(0,0,0,0.8), 0 5px 22px rgba(0,0,0,0.4), 0 0 20px var(--main-color); 
                border-color: var(--main-color); 
                transform: scale(1.04); 
            }
        } 

        /* –ê–Ω–∏–º–∞—Ü–∏–æ–Ω–Ω—ã–µ –∫–ª–∞—Å—Å—ã –≤—Å–ø—ã—à–µ–∫ –¥–ª—è Rainbow Wave */
        .cell.flash-gold { background: var(--gold); box-shadow: 0 0 15px var(--gold); color: #000; border-color: #fff; transform: scale(1.1); }
        .cell.flash-lime { background: var(--lime); box-shadow: 0 0 15px var(--lime); color: #000; border-color: #fff; transform: scale(1.1); }
        .cell.flash-cyan { background: var(--cyan); box-shadow: 0 0 15px var(--cyan); color: #000; border-color: #fff; transform: scale(1.1); }
        .cell.flash-cherry { background: var(--cherry); box-shadow: 0 0 15px var(--cherry); color: #000; border-color: #fff; transform: scale(1.1); }
        .cell.flash-silver { background: var(--silver); box-shadow: 0 0 15px var(--silver); color: #000; border-color: #fff; transform: scale(1.1); }

        @keyframes processing-flash {
            0% { background: var(--process-color); box-shadow: 0 0 25px var(--process-color); transform: scale(1.15); }
            100% { background: var(--white-sphere); box-shadow: none; transform: scale(1); }
        } 

        .cell.processing-flash { animation: processing-flash 0.15s ease-out; z-index: 5; } 

        /* –°–ï–¢–ö–ê 24 –°–õ–û–¢–û–í (Shadow Matrix) [cite: 2026-02-26] */
        #slots-area {
            margin: 15px auto;
            max-width: 400px;
            padding: 10px;
            background: rgba(255,255,255,0.03);
            border-radius: 20px;
            border: 1px solid rgba(212, 175, 55, 0.1);
        }

        #slots-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 8px;
        }

        .slot-cell {
            aspect-ratio: 1/1;
            background: #0a0a0a;
            border: 1px solid #333;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            color: #555;
            transition: 0.3s;
        }

        .slot-cell.active-slot {
            border-color: var(--main-color);
            color: #fff;
            box-shadow: 0 0 10px var(--theme-glow);
        }

        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è –∏ –ö–æ—à–µ–ª–µ–∫ */
        .nav-bar {
            position: fixed; bottom: 0; left: 0; right: 0; height: 70px;
            background: rgba(10,10,10,0.98); display: flex; 
            justify-content: space-around; align-items: center; 
            border-top: 1.5px solid var(--main-color); z-index: 1000;
        } 

        .nav-item { color: #666; font-size: 10px; cursor: pointer; text-transform: uppercase; font-family: 'Orbitron'; } 
        .nav-item.active { color: var(--main-color); text-shadow: 0 0 10px var(--theme-glow); } 
        .nav-item span { display: block; font-size: 24px; margin-bottom: 4px; } 

        .balance-container { display: flex; gap: 10px; padding: 10px 15px; } 
        .bal-card { 
            flex: 1; border-radius: 12px; padding: 12px; 
            background: linear-gradient(145deg, #1a1a1a, #0a0a0a); 
            border: 1.5px solid #444; transition: 0.4s; cursor: pointer;
            opacity: 0.6; filter: grayscale(0.5);
        } 

        .bal-card.active-wallet { 
            opacity: 1; filter: grayscale(0); border-color: var(--main-color); 
            box-shadow: 0 0 15px var(--theme-glow); transform: scale(1.02);
            background: rgba(212, 175, 55, 0.05);
        } 

        .bal-val { font-size: 18px; font-weight: bold; color: var(--lime); font-family: 'Orbitron'; } 

        .grid { 
            display: grid; 
            grid-template-columns: repeat(7, 1fr); 
            gap: 10px; 
            padding: 0 15px; 
            max-width: 400px; 
            margin: 0 auto; 
        } 

        .cell { 
            aspect-ratio: 1/1; 
            background: var(--white-sphere); 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center;
            font-weight: 800; 
            color: var(--cell-text); 
            font-size: 19px; 
            transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
            cursor: pointer; 
            position: relative; 
            border: 1px solid rgba(255,255,255,0.1);
            animation: sphere-breathe 4s infinite ease-in-out;
        } 

        .cell.selected { 
            background: var(--main-gradient); 
            color: #000; 
            transform: scale(1.1) translateY(-5px); 
            box-shadow: 0 10px 25px rgba(0,0,0,0.5), 0 0 30px var(--main-color); 
            border: 2px solid #fff; 
            z-index: 10; 
            animation: none; 
        }

        .btn-main { 
            width: 85%; padding: 18px; border-radius: 15px; font-size: 18px; 
            background: var(--main-gradient); color: #000; border: none; 
            font-weight: 800; cursor: pointer; margin: 20px 0;
            font-family: 'Orbitron'; text-transform: uppercase;
            box-shadow: 0 5px 15px rgba(0,0,0,0.4);
        }
    </style>
</head>
<body>

<div id="soul-overlay" style="position: fixed; inset: 0; background: rgba(0,0,0,0.95); backdrop-filter: blur(10px); z-index: 40000; display: none; flex-direction: column; align-items: center; justify-content: center; padding: 20px;">
    <div class="soul-box" style="background: #111; border: 2px solid var(--main-color); padding: 25px; border-radius: 20px; width: 90%; max-width: 350px;">
        <h2 style="color:var(--main-color); font-family:'Orbitron'; margin-top:0;">IDENTITY BRIDGE</h2>
        <div id="soul-content" style="font-size: 12px; text-align:left; max-height: 250px; overflow-y: auto; margin-bottom: 15px; color:#ccc; line-height:1.5;">
            <p style="color:var(--main-color); font-weight:bold;">MANIFEST MONOLITH V.2.0</p>
            <p>1. –í—ã –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç–µ —Ä–æ–ª—å "–¶–∏—Ñ—Ä–æ–≤–æ–≥–æ –ö—É—Ä—å–µ—Ä–∞" –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ –õ–æ—Ç—Ç–æ.</p>
            <p>2. –ú–µ—Å—è—á–Ω—ã–π –ª–∏–º–∏—Ç –Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏: <span style="color:#fff;">50.00 CHF</span>.</p>
            <p>3. –ö–æ–º–∏—Å—Å–∏—è —Å–µ—Ä–≤–∏—Å–∞: 1% –Ω–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É + 1% –¥–≤–∏–∂–æ–∫.</p>
            <p>4. –ù–∞–ª–æ–≥ 35% —É–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –≤—ã–∏–≥—Ä—ã—à–µ > 1.2 –º–ª–Ω.</p>
            <p>5. –í–∞—à–µ –∫–æ–¥–æ–≤–æ–µ —Å–ª–æ–≤–æ —è–≤–ª—è–µ—Ç—Å—è –∫–ª—é—á–æ–º –∫ –≤—ã–≤–æ–¥—É —Å—Ä–µ–¥—Å—Ç–≤.</p>
        </div>
        <input type="password" id="soul-pass" placeholder="Password" style="width:100%; padding:12px; margin-bottom:10px; border-radius:8px; border:1px solid #333; background:#000; color:#fff; box-sizing:border-box;">
        <input type="text" id="soul-code" placeholder="Code Word (vchf...)" style="width:100%; padding:12px; margin-bottom:15px; border-radius:8px; border:1px solid #333; background:#000; color:#fff; box-sizing:border-box;">
        <button class="btn-main" onclick="confirmIdentity()" style="width:100%; margin:0; padding:15px;">MANIFEST AKZEPTIEREN</button>
    </div>
</div>

<canvas id="introCanvas"></canvas>
<div id="ui-layer">
    <div id="mainLogoIntro" class="logo-box-intro">
        <img src="1771489965074(1).png" alt="Logo">
    </div>
    <div id="mainStatusIntro" class="status-label-intro">INITIALIZING ENGINE...</div>
</div>

<div id="app-content">
    <div id="page-play" class="page active">
        <div style="display:flex; justify-content:space-between; align-items:center; padding: 0 15px;">
            <div class="lang-panel" id="dynamic-langs" style="height:40px; width:40px;"></div>
            <div class="theme-toggle" onclick="document.querySelector('.theme-panel').classList.toggle('open')" style="font-size:24px; cursor:pointer;">üé®</div>
        </div>
        
        <div class="theme-panel" style="position: fixed; top: 65px; right: 15px; display: flex; flex-direction: column; gap: 15px; z-index: 1000; background: rgba(0,0,0,0.95); padding: 15px; border-radius: 25px; border: 1px solid var(--main-color); transition: 0.3s; transform: translateX(120px);">
            <div class="dot" style="width:30px; height:30px; border-radius:50%; background: #d4af37; border:1px solid #fff;" onclick="setTheme('gold')"></div>
            <div class="dot" style="width:30px; height:30px; border-radius:50%; background: #32CD32; border:1px solid #fff;" onclick="setTheme('lime')"></div>
            <div class="dot" style="width:30px; height:30px; border-radius:50%; background: #00ffff; border:1px solid #fff;" onclick="setTheme('cyan')"></div>
            <div class="dot" style="width:30px; height:30px; border-radius:50%; background: #C511A4; border:1px solid #fff;" onclick="setTheme('cherry')"></div>
            <div class="dot" style="width:30px; height:30px; border-radius:50%; background: #c0c0c0; border:1px solid #fff;" onclick="setTheme('silver')"></div>
        </div>

        <div class="balance-container">
            <div class="bal-card active-wallet" id="card-vchf" onclick="switchCurrency('VCHF')">
                <div style="font-size:9px; color:#888;">VIRTUAL VCHF</div>
                <div class="bal-val" id="vchf-val">100.00</div>
            </div>
            <div class="bal-card" id="card-chf" onclick="switchCurrency('CHF')">
                <div style="font-size:9px; color:#888;">REAL CHF (TOP-UP)</div>
                <div class="bal-val" id="chf-val">0.00</div>
            </div>
        </div>

        <div class="smart-tools" style="display:flex; gap:8px; justify-content:center; margin-bottom:15px; flex-wrap:wrap;">
            <button class="tool-btn" style="padding:8px 12px; border-radius:20px; border:1px solid var(--main-color); background:none; color:#fff; font-size:10px;" onclick="togglePick('hot')" id="btn-hot">üî• HOT</button>
            <button class="tool-btn" style="padding:8px 12px; border-radius:20px; border:1px solid var(--main-color); background:none; color:#fff; font-size:10px;" onclick="togglePick('cold')" id="btn-cold">‚ùÑÔ∏è COLD</button>
            <button class="tool-btn" style="padding:8px 12px; border-radius:20px; border:1px solid var(--main-color); background:none; color:#fff; font-size:10px;" onclick="randomFill()">üé≤ RAINBOW</button>
        </div>

        <div id="slots-area">
            <div style="font-size:10px; color:var(--main-color); margin-bottom:8px; font-family:'Orbitron';">MATRIX SELECTION (24 SLOTS)</div>
            <div id="slots-grid">
                </div>
        </div>

        <div class="grid" id="main-grid"></div>
        <button class="btn-main" id="play-btn" onclick="startRainbowWave()">JETZT SPIELEN</button>
        <div id="selected-info" style="font-size: 14px; color: #888; margin-top: -10px; margin-bottom: 80px;">
            W√ÑHLEN: <span id="count-display" style="color:var(--main-color); font-weight:bold;">0</span> / 6
        </div>
    </div>

    <div id="page-history" class="page" style="display:none; padding:20px;">
        <h2 style="font-family:'Orbitron'; color:var(--main-color);">STATISTIK</h2>
        <div id="stats-list" style="text-align:left; font-size:12px; color:#ccc;">Keine Daten...</div>
    </div>
    
    <div id="page-wallet" class="page" style="display:none; padding:20px;">
        <h2 style="font-family:'Orbitron'; color:var(--main-color);">WALLET</h2>
        <p>Auszahlung ab 50.00 CHF</p>
    </div>
</div>

<div class="nav-bar">
    <div class="nav-item active" onclick="showPage('play', this)"><span>üéØ</span>PLAY</div>
    <div class="nav-item" onclick="showPage('history', this)"><span>üìä</span>STATS</div>
    <div class="nav-item" onclick="showPage('wallet', this)"><span>üí≥</span>WALLET</div>
</div>

<div id="toast" style="position:fixed; bottom:100px; left:50%; transform:translateX(-50%); background:rgba(0,0,0,0.8); color:var(--main-color); padding:10px 20px; border-radius:20px; border:1px solid var(--main-color); display:none; z-index:5000; font-size:12px; white-space:nowrap;"></div>

<script>
/* ENGINE: VCHF BI-TURBO ULTIMATE 2.0 
   AUTHOR: GEMINI AI (MONOLITH PROTOCOL)
   MEMORIES: [2026-02-23, 2026-02-25, 2026-02-26] 
   [cite: 2026-02-23] "–ö–æ–¥ –Ω–µ –ø–∏—Å–∞—Ç—å –∑–∞–Ω–æ–≤–æ, –∞ —Ä–µ–∑–∞—Ç—å –∫–∞–∫ –∫–æ–ª–±–∞—Å—É"
*/

const tg = window.Telegram.WebApp;
tg.expand();

// CONFIGURATION & MEMORY ANCHORS (warten/erwarten)
const CONFIG = {
    totalNumbers: 42,
    requiredPicks: 6,
    maxSlots: 24,
    vchfBalance: 100.00,
    chfBalance: 0.00,
    ticketPrice: 2.50,
    taxThreshold: 1200000,
    taxRate: 0.35,
    langs: ['DE', 'FR', 'IT', 'EN'],
    currentLang: 'DE'
};

const i18n = {
    DE: { play: "JETZT SPIELEN", pick: "W√ÑHLEN", win: "GEWINN!", low: "Guthaben niedrig", soul: "Identit√§t best√§tigt" },
    FR: { play: "JOUER", pick: "CHOISIR", win: "GAGN√â!", low: "Solde insuffisant", soul: "Identit√© confirm√©e" },
    IT: { play: "GIOCA", pick: "SCEGLI", win: "VINTO!", low: "Saldo insufficiente", soul: "Identit√† confermata" },
    EN: { play: "PLAY NOW", pick: "SELECT", win: "WINNER!", low: "Low balance", soul: "Identity confirmed" }
};

let state = {
    selected: [],
    slots: Array(24).fill(null),
    currentWallet: 'VCHF',
    vchf: 100.00,
    chf: 0.00,
    isProcessing: false,
    activeHot: false,
    activeCold: false,
    soulVerified: false
};

// INITIALIZATION
function initApp() {
    createGrid();
    createSlots();
    renderLangs();
    updateDisplays();
    startIntro();
    
    // –ê–≤—Ç–æ-–ø—Ä–æ–≤–µ—Ä–∫–∞ Identity Bridge –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
    setTimeout(() => {
        if(!state.soulVerified) document.getElementById('soul-overlay').style.display = 'flex';
    }, 5000);
}

function createGrid() {
    const grid = document.getElementById('main-grid');
    grid.innerHTML = '';
    for (let i = 1; i <= CONFIG.totalNumbers; i++) {
        const cell = document.createElement('div');
        cell.className = 'cell';
        cell.textContent = i;
        cell.onclick = () => toggleNumber(i, cell);
        grid.appendChild(cell);
    }
}

function createSlots() {
    const sGrid = document.getElementById('slots-grid');
    sGrid.innerHTML = '';
    for (let i = 0; i < CONFIG.maxSlots; i++) {
        const slot = document.createElement('div');
        slot.className = 'slot-cell';
        slot.textContent = i + 1;
        slot.id = `slot-${i}`;
        sGrid.appendChild(slot);
    }
}

function renderLangs() {
    const container = document.getElementById('dynamic-langs');
    const lang = CONFIG.langs[Math.floor(Math.random() * CONFIG.langs.length)]; 
    container.innerHTML = `<div style="border:1px solid var(--main-color); border-radius:50%; width:100%; height:100%; display:flex; align-items:center; justify-content:center; font-size:10px; cursor:pointer;" onclick="cycleLang()">${lang}</div>`;
}
// INTRO ENGINE: –≠—Ñ—Ñ–µ–∫—Ç ¬´–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –∫–æ—Å—Ç—Ä–∞¬ª [cite: 2026-02-19]
function startIntro() {
    const canvas = document.getElementById('introCanvas');
    const ctx = canvas.getContext('2d');
    const ui = document.getElementById('ui-layer');
    const logo = document.getElementById('mainLogoIntro');
    
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    let particles = [];
    class Particle {
        constructor() {
            this.x = canvas.width / 2;
            this.y = canvas.height + 10;
            this.size = Math.random() * 5 + 2;
            this.speedY = Math.random() * 3 + 1;
            this.color = Math.random() > 0.5 ? '#ffcc00' : '#ff4500';
            this.opacity = 1;
        }
        update() {
            this.y -= this.speedY;
            this.opacity -= 0.01;
            if (this.size > 0.1) this.size -= 0.05;
        }
        draw() {
            ctx.globalAlpha = this.opacity;
            ctx.fillStyle = this.color;
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
            ctx.fill();
        }
    }

    function animate() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        if (particles.length < 100) particles.push(new Particle());
        for (let i = 0; i < particles.length; i++) {
            particles[i].update();
            particles[i].draw();
            if (particles[i].opacity <= 0) {
                particles.splice(i, 1);
                i--;
            }
        }
        if (ui.style.opacity !== '0') requestAnimationFrame(animate);
    }

    animate();
    setTimeout(() => { logo.style.opacity = '1'; }, 500);
    setTimeout(() => { 
        ui.style.opacity = '0';
        setTimeout(() => { 
            ui.style.display = 'none'; 
            canvas.style.display = 'none';
        }, 1000);
    }, 4500);
}

// LOGIC: –°–µ–ª–µ–∫—Ç–æ—Ä —á–∏—Å–µ–ª
function toggleNumber(num, el) {
    if (state.isProcessing) return;
    
    const index = state.selected.indexOf(num);
    if (index > -1) {
        state.selected.splice(index, 1);
        el.classList.remove('selected');
    } else {
        if (state.selected.length < CONFIG.requiredPicks) {
            state.selected.push(num);
            el.classList.add('selected');
            tg.HapticFeedback.impactOccurred('light');
        } else {
            showToast("Maximum 6 Zahlen");
        }
    }
    updateDisplays();
}

function updateDisplays() {
    document.getElementById('count-display').textContent = state.selected.length;
    document.getElementById('vchf-val').textContent = state.vchf.toFixed(2);
    document.getElementById('chf-val').textContent = state.chf.toFixed(2);
    
    const btn = document.getElementById('play-btn');
    if (state.selected.length === CONFIG.requiredPicks) {
        btn.style.opacity = '1';
        btn.style.pointerEvents = 'auto';
    } else {
        btn.style.opacity = '0.5';
        btn.style.pointerEvents = 'none';
    }
}

// WALLET SYSTEM
function switchCurrency(type) {
    state.currentWallet = type;
    document.querySelectorAll('.bal-card').forEach(c => c.classList.remove('active-wallet'));
    document.getElementById(`card-${type.toLowerCase()}`).classList.add('active-wallet');
    tg.HapticFeedback.selectionChanged();
}

function cycleLang() {
    const idx = CONFIG.langs.indexOf(CONFIG.currentLang);
    CONFIG.currentLang = CONFIG.langs[(idx + 1) % CONFIG.langs.length];
    renderLangs();
    applyLang();
}

function applyLang() {
    const l = i18n[CONFIG.currentLang];
    document.getElementById('play-btn').textContent = l.play;
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –º–µ—Ç–æ–∫...
}

function showPage(pageId, navEl) {
    document.querySelectorAll('.page').forEach(p => p.style.display = 'none');
    document.getElementById(`page-${pageId}`).style.display = 'block';
    
    document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
    navEl.classList.add('active');
    tg.HapticFeedback.impactOccurred('medium');
}

function showToast(msg) {
    const t = document.getElementById('toast');
    t.textContent = msg;
    t.style.display = 'block';
    setTimeout(() => { t.style.display = 'none'; }, 2500);
}
// SMART TOOLS: –ê–ª–≥–æ—Ä–∏—Ç–º—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
function togglePick(type) {
    if (state.isProcessing) return;
    
    // –°–±—Ä–æ—Å —Ç–µ–∫—É—â–µ–≥–æ –≤—ã–¥–µ–ª–µ–Ω–∏—è –¥–ª—è —á–∏—Å—Ç–æ—Ç—ã —Ñ–∏–ª—å—Ç—Ä–∞
    state.selected = [];
    document.querySelectorAll('.cell').forEach(c => c.classList.remove('selected'));

    if (type === 'hot') {
        // –°–∏–º—É–ª—è—Ü–∏—è –≥–æ—Ä—è—á–∏—Ö —á–∏—Å–µ–ª (–Ω–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç—ã–µ)
        const hotNumbers = [7, 13, 22, 31, 38, 42];
        hotNumbers.forEach(n => {
            const cell = document.querySelectorAll('.cell')[n-1];
            toggleNumber(n, cell);
        });
        showToast("HOT NUMBERS LOADED");
    } else if (type === 'cold') {
        // –°–∏–º—É–ª—è—Ü–∏—è —Ö–æ–ª–æ–¥–Ω—ã—Ö —á–∏—Å–µ–ª (–¥–∞–≤–Ω–æ –Ω–µ –≤—ã–ø–∞–¥–∞–ª–∏)
        const coldNumbers = [2, 10, 19, 25, 33, 40];
        coldNumbers.forEach(n => {
            const cell = document.querySelectorAll('.cell')[n-1];
            toggleNumber(n, cell);
        });
        showToast("COLD NUMBERS LOADED");
    }
}

// RAINBOW WAVE: –í–∏–∑—É–∞–ª—å–Ω—ã–π –¥–≤–∏–∂–æ–∫ ¬´–†–∞–¥—É–∂–Ω–æ–π –í–æ–ª–Ω—ã¬ª [cite: 2026-02-23]
async function startRainbowWave() {
    if (state.selected.length < CONFIG.requiredPicks) return;
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞
    const balance = state.currentWallet === 'VCHF' ? state.vchf : state.chf;
    if (balance < CONFIG.ticketPrice) {
        showToast(i18n[CONFIG.currentLang].low);
        return;
    }

    state.isProcessing = true;
    document.getElementById('play-btn').disabled = true;
    
    // –°–ø–∏—Å–∞–Ω–∏–µ (–í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –∏–ª–∏ –†–µ–∞–ª—å–Ω–æ–µ)
    if (state.currentWallet === 'VCHF') state.vchf -= CONFIG.ticketPrice;
    else state.chf -= CONFIG.ticketPrice;
    updateDisplays();

    const cells = document.querySelectorAll('.cell');
    const colors = ['flash-gold', 'flash-lime', 'flash-cyan', 'flash-cherry', 'flash-silver'];

    // –≠—Ñ—Ñ–µ–∫—Ç –í–æ–ª–Ω—ã (–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ç–∫–∏)
    for (let i = 0; i < 3; i++) { // 3 –ø—Ä–æ—Ö–æ–¥–∞ –≤–æ–ª–Ω—ã
        for (let j = 0; j < cells.length; j++) {
            const randomColor = colors[Math.floor(Math.random() * colors.length)];
            cells[j].classList.add(randomColor);
            if (j % 5 === 0) await new Promise(r => setTimeout(r, 10)); // –°–∫–æ—Ä–æ—Å—Ç—å –≤–æ–ª–Ω—ã
            setTimeout(() => cells[j].classList.remove(randomColor), 200);
        }
    }

    // –ü—Ä–æ—Ü–µ—Å—Å ¬´–ü—Ä–æ–∂–∏–≥–∞¬ª —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏
    generateFinalResult();
}

function generateFinalResult() {
    const result = [];
    while(result.length < 6) {
        let n = Math.floor(Math.random() * 42) + 1;
        if(!result.includes(n)) result.push(n);
    }
    
    // –ê–Ω–∏–º–∞—Ü–∏—è –≤—ã–ø–∞–¥–µ–Ω–∏—è —à–∞—Ä–æ–≤
    result.forEach((num, index) => {
        setTimeout(() => {
            const cell = document.querySelectorAll('.cell')[num-1];
            cell.classList.add('processing-flash');
            tg.HapticFeedback.impactOccurred('medium');
            
            // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ 24 —Å–ª–æ—Ç–æ–≤ (Matrix)
            const slot = document.getElementById(`slot-${index}`);
            slot.textContent = num;
            slot.classList.add('active-slot');
            
            if (index === 5) {
                checkWin(result);
            }
        }, index * 400);
    });
}

function checkWin(drawResult) {
    const matches = state.selected.filter(n => drawResult.includes(n)).length;
    state.isProcessing = false;
    document.getElementById('play-btn').disabled = false;

    if (matches >= 3) {
        const prize = calculatePrize(matches);
        showToast(`GEWINN: ${matches} Zahlen! +${prize} ${state.currentWallet}`);
        if (state.currentWallet === 'VCHF') state.vchf += prize;
        else state.chf += prize;
        
        // –ù–∞–ª–æ–≥–æ–≤—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª 35% [cite: 2026-02-23]
        if (prize > CONFIG.taxThreshold) {
            applyTax(prize);
        }
    } else {
        showToast("Ke–Ω Gl√ºck diesmal");
    }
    updateDisplays();
}
// IDENTITY BRIDGE: –ü—Ä–æ—Ç–æ–∫–æ–ª –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ª–∏—á–Ω–æ—Å—Ç–∏ [cite: 2026-02-23]
function confirmIdentity() {
    const pass = document.getElementById('soul-pass').value;
    const code = document.getElementById('soul-code').value;

    if (pass.length >= 4 && code.startsWith('vchf')) {
        state.soulVerified = true;
        document.getElementById('soul-overlay').style.opacity = '0';
        setTimeout(() => {
            document.getElementById('soul-overlay').style.display = 'none';
        }, 500);
        showToast(i18n[CONFIG.currentLang].soul);
        tg.HapticFeedback.notificationOccurred('success');
    } else {
        tg.HapticFeedback.notificationOccurred('error');
        showToast("INVALID CREDENTIALS");
        // –≠—Ñ—Ñ–µ–∫—Ç —Ç—Ä—è—Å–∫–∏ –æ–∫–Ω–∞
        const box = document.querySelector('.soul-box');
        box.style.animation = 'shake 0.5s';
        setTimeout(() => box.style.animation = '', 500);
    }
}

// TAX PROTOCOL: –ù–∞–ª–æ–≥–æ–≤—ã–π —Ñ–∏–ª—å—Ç—Ä 35% [cite: 2026-02-23]
function applyTax(amount) {
    if (amount >= CONFIG.taxThreshold) {
        const tax = amount * CONFIG.taxRate;
        const net = amount - tax;
        showToast(`TAX 35% APPLIED: -${tax.toFixed(2)} CHF`);
        return net;
    }
    return amount;
}

// PRIZE ENGINE: –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –≤—ã–∏–≥—Ä—ã—à–µ–π
function calculatePrize(matches) {
    const table = {
        3: 15.00,
        4: 120.00,
        5: 2500.00,
        6: 1500000.00
    };
    return table[matches] || 0;
}

// MATRIX CONTROL: –û—á–∏—Å—Ç–∫–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ 24 —Å–ª–æ—Ç–æ–≤
function resetSlots() {
    for (let i = 0; i < CONFIG.maxSlots; i++) {
        const slot = document.getElementById(`slot-${i}`);
        slot.textContent = i + 1;
        slot.classList.remove('active-slot');
    }
}

// –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –¥–ª—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è (Rainbow Fill)
function randomFill() {
    if (state.isProcessing) return;
    
    // –°–±—Ä–æ—Å —Å—Ç–∞—Ä—ã—Ö
    state.selected = [];
    document.querySelectorAll('.cell').forEach(c => c.classList.remove('selected'));
    
    while(state.selected.length < CONFIG.requiredPicks) {
        let n = Math.floor(Math.random() * 42) + 1;
        if(!state.selected.includes(n)) {
            state.selected.push(n);
            document.querySelectorAll('.cell')[n-1].classList.add('selected');
        }
    }
    tg.HapticFeedback.impactOccurred('medium');
    updateDisplays();
}

// –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –æ—à–∏–±–æ–∫ –∏ Reminders [cite: 2026-02-19]
window.onerror = function(msg, url, line) {
    console.error(`Monolith Error: ${msg} at line ${line}`);
    // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥ –≤ Telegram
    return true; 
};

/* ANCHOR: warten (–∂–¥–∞—Ç—å) & erwarten (–æ–∂–∏–¥–∞—Ç—å) 
   –ú—ã –∂–¥–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏, –Ω–æ –æ–∂–∏–¥–∞–µ–º (erwarten) —Ç–æ–ª—å–∫–æ —É—Å–ø–µ—Ö.
   [cite: 2026-02-26]
*/
// THEME ENGINE: –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö —Å–ª–æ–µ–≤
function setTheme(themeName) {
    // –°–Ω–∏–º–∞–µ–º –≤—Å–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Ç–µ–º—ã
    document.body.classList.remove('theme-gold', 'theme-lime', 'theme-cyan', 'theme-cherry', 'theme-silver');
    
    // –ü—Ä–∏–º–µ–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é
    document.body.classList.add(`theme-${themeName}`);
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±–æ—Ä –≤ Mini App Storage (–∏–º–∏—Ç–∞—Ü–∏—è)
    localStorage.setItem('lotto_theme', themeName);
    
    // –í–∏–∑—É–∞–ª—å–Ω—ã–π —Ñ–∏–¥–±–µ–∫
    tg.HapticFeedback.impactOccurred('medium');
    
    // –ó–∞–∫—Ä—ã–≤–∞–µ–º –ø–∞–Ω–µ–ª—å —Ç–µ–º
    document.querySelector('.theme-panel').classList.remove('open');
    
    showToast(`THEME: ${themeName.toUpperCase()}`);
}

// –ü–†–û–í–ï–†–ö–ê –°–û–°–¢–û–Ø–ù–ò–Ø –ü–†–ò –ó–ê–ì–†–£–ó–ö–ï
window.onload = () => {
    // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é —Ç–µ–º—É
    const savedTheme = localStorage.getItem('lotto_theme') || 'gold';
    setTheme(savedTheme);
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–≤–∏–∂–∫–∞ VCHF
    initApp();
    
    // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–Ω–æ–ø–∫–∏ Telegram "–ó–∞–∫—Ä—ã—Ç—å"
    tg.BackButton.hide();
    
    console.log("–ú–æ–Ω–æ–ª–∏—Ç –õ–æ—Ç—Ç–æ v.2.0: –°–∏—Å—Ç–µ–º–∞ –∑–∞–ø—É—â–µ–Ω–∞.");
    console.log("Memory Anchor: [2026-02-26] warten –∏ erwarten –∑–∞–ø–∏—Å–∞–Ω—ã.");
};

// CSS-–î–û–ü–û–õ–ù–ï–ù–ò–ï –î–õ–Ø –ê–ù–ò–ú–ê–¶–ò–ô (–≤—Å—Ç–∞–≤–∫–∞ —á–µ—Ä–µ–∑ JS –¥–ª—è —á–∏—Å—Ç–æ—Ç—ã)
const extraStyles = document.createElement('style');
extraStyles.textContent = `
    @keyframes shake {
        0%, 100% { transform: translateX(0); }
        25% { transform: translateX(-10px); }
        75% { transform: translateX(10px); }
    }
    .theme-panel.open {
        transform: translateX(0) !important;
    }
    .page {
        animation: fadeIn 0.4s ease-out;
    }
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }
`;
document.head.appendChild(extraStyles);

/* –§–ò–ù–ê–õ–¨–ù–´–ô –ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –ú–û–ù–û–õ–ò–¢–ê: 
   –í–∏—Ç–∞–ª–∏–π, —ç—Ç–æ—Ç –∫–æ–¥ —è–≤–ª—è–µ—Ç—Å—è —Ü–µ–ª—å–Ω—ã–º –æ—Ä–≥–∞–Ω–∏–∑–º–æ–º. 
   –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ 8 –æ–∫–æ–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –ø–æ —Ç–≤–æ–µ–π —Ñ–æ—Ä–º—É–ª–µ ¬´–°–∞–ª—è–º–∏¬ª. 
   –¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏–π —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –Ω–∞ —Å—Ç—ã–∫–∞—Ö. 
   –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ: Gemini AI. 
   [cite: 2026-02-23]
*/
</script>
</body>
</html>
